ARM GAS  /tmp/ccxgooGA.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"ft5206.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.ft5206_wr_reg,"ax",%progbits
  18              		.align	1
  19              		.global	ft5206_wr_reg
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	ft5206_wr_reg:
  27              	.LVL0:
  28              	.LFB126:
  29              		.file 1 "HADRWARE/TOUCH/ft5206.c"
   1:HADRWARE/TOUCH/ft5206.c **** /**
   2:HADRWARE/TOUCH/ft5206.c ****  **************************************************************************************************
   3:HADRWARE/TOUCH/ft5206.c ****  * @file        ft5206.c
   4:HADRWARE/TOUCH/ft5206.c ****  * @author      正点原子团队(ALIENTEK)
   5:HADRWARE/TOUCH/ft5206.c ****  * @version     V1.1
   6:HADRWARE/TOUCH/ft5206.c ****  * @date        2022-12-27
   7:HADRWARE/TOUCH/ft5206.c ****  * @brief       7寸电容触摸屏-FT5206/FT5426 驱动代码
   8:HADRWARE/TOUCH/ft5206.c ****  * @license     Copyright (c) 2022-2032, 广州市星翼电子科技有限公司
   9:HADRWARE/TOUCH/ft5206.c ****  **************************************************************************************************
  10:HADRWARE/TOUCH/ft5206.c ****  * @attention
  11:HADRWARE/TOUCH/ft5206.c ****  *
  12:HADRWARE/TOUCH/ft5206.c ****  * 实验平台:正点原子 阿波罗 F429开发板
  13:HADRWARE/TOUCH/ft5206.c ****  * 在线视频:www.yuanzige.com
  14:HADRWARE/TOUCH/ft5206.c ****  * 技术论坛:www.openedv.com
  15:HADRWARE/TOUCH/ft5206.c ****  * 公司网址:www.alientek.com
  16:HADRWARE/TOUCH/ft5206.c ****  * 购买地址:openedv.taobao.com
  17:HADRWARE/TOUCH/ft5206.c ****  *
  18:HADRWARE/TOUCH/ft5206.c ****  * 修改说明
  19:HADRWARE/TOUCH/ft5206.c ****  * V1.0 20221227
  20:HADRWARE/TOUCH/ft5206.c ****  * 第一次发布
  21:HADRWARE/TOUCH/ft5206.c ****  * V1.1 20230607
  22:HADRWARE/TOUCH/ft5206.c ****  * 兼容7寸 CST340触摸屏
  23:HADRWARE/TOUCH/ft5206.c ****  *
  24:HADRWARE/TOUCH/ft5206.c ****  **************************************************************************************************
  25:HADRWARE/TOUCH/ft5206.c ****  */
  26:HADRWARE/TOUCH/ft5206.c **** 
  27:HADRWARE/TOUCH/ft5206.c **** #include "string.h"
  28:HADRWARE/TOUCH/ft5206.c **** #include "lcd.h"
  29:HADRWARE/TOUCH/ft5206.c **** #include "touch.h"
ARM GAS  /tmp/ccxgooGA.s 			page 2


  30:HADRWARE/TOUCH/ft5206.c **** #include "ctiic.h"
  31:HADRWARE/TOUCH/ft5206.c **** #include "ft5206.h"
  32:HADRWARE/TOUCH/ft5206.c **** #include "usart.h"
  33:HADRWARE/TOUCH/ft5206.c **** #include "delay.h"
  34:HADRWARE/TOUCH/ft5206.c **** 
  35:HADRWARE/TOUCH/ft5206.c **** 
  36:HADRWARE/TOUCH/ft5206.c **** /**
  37:HADRWARE/TOUCH/ft5206.c ****  * @brief       向FT5206写入一次数据
  38:HADRWARE/TOUCH/ft5206.c ****  * @param       reg : 起始寄存器地址
  39:HADRWARE/TOUCH/ft5206.c ****  * @param       buf : 数据缓缓存区
  40:HADRWARE/TOUCH/ft5206.c ****  * @param       len : 写数据长度
  41:HADRWARE/TOUCH/ft5206.c ****  * @retval      0, 成功; 1, 失败;
  42:HADRWARE/TOUCH/ft5206.c ****  */
  43:HADRWARE/TOUCH/ft5206.c **** uint8_t ft5206_wr_reg(uint16_t reg, uint8_t *buf, uint8_t len)
  44:HADRWARE/TOUCH/ft5206.c **** {
  30              		.loc 1 44 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 44 1 is_stmt 0 view .LVU1
  35 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 24
  38              		.cfi_offset 3, -24
  39              		.cfi_offset 4, -20
  40              		.cfi_offset 5, -16
  41              		.cfi_offset 6, -12
  42              		.cfi_offset 7, -8
  43              		.cfi_offset 14, -4
  44 0002 0446     		mov	r4, r0
  45 0004 0F46     		mov	r7, r1
  46 0006 1546     		mov	r5, r2
  45:HADRWARE/TOUCH/ft5206.c ****     uint8_t i;
  47              		.loc 1 45 5 is_stmt 1 view .LVU2
  46:HADRWARE/TOUCH/ft5206.c ****     uint8_t ret = 0;
  48              		.loc 1 46 5 view .LVU3
  49              	.LVL1:
  47:HADRWARE/TOUCH/ft5206.c ****     ct_iic_start();
  50              		.loc 1 47 5 view .LVU4
  51 0008 FFF7FEFF 		bl	ct_iic_start
  52              	.LVL2:
  48:HADRWARE/TOUCH/ft5206.c ****     ct_iic_send_byte(FT5206_CMD_WR);    /* 发送写命令 */
  53              		.loc 1 48 5 view .LVU5
  54 000c 7020     		movs	r0, #112
  55 000e FFF7FEFF 		bl	ct_iic_send_byte
  56              	.LVL3:
  49:HADRWARE/TOUCH/ft5206.c ****     ct_iic_wait_ack();
  57              		.loc 1 49 5 view .LVU6
  58 0012 FFF7FEFF 		bl	ct_iic_wait_ack
  59              	.LVL4:
  50:HADRWARE/TOUCH/ft5206.c ****     ct_iic_send_byte(reg & 0XFF);       /* 发送低8位地址 */
  60              		.loc 1 50 5 view .LVU7
  61 0016 E0B2     		uxtb	r0, r4
  62 0018 FFF7FEFF 		bl	ct_iic_send_byte
  63              	.LVL5:
  51:HADRWARE/TOUCH/ft5206.c ****     ct_iic_wait_ack();
  64              		.loc 1 51 5 view .LVU8
ARM GAS  /tmp/ccxgooGA.s 			page 3


  65 001c FFF7FEFF 		bl	ct_iic_wait_ack
  66              	.LVL6:
  52:HADRWARE/TOUCH/ft5206.c **** 
  53:HADRWARE/TOUCH/ft5206.c ****     for (i = 0; i < len; i++)
  67              		.loc 1 53 5 view .LVU9
  46:HADRWARE/TOUCH/ft5206.c ****     ct_iic_start();
  68              		.loc 1 46 13 is_stmt 0 view .LVU10
  69 0020 0026     		movs	r6, #0
  70              		.loc 1 53 12 view .LVU11
  71 0022 3446     		mov	r4, r6
  72              		.loc 1 53 5 view .LVU12
  73 0024 01E0     		b	.L2
  74              	.LVL7:
  75              	.L6:
  76              		.loc 1 53 26 is_stmt 1 discriminator 2 view .LVU13
  77              		.loc 1 53 27 is_stmt 0 discriminator 2 view .LVU14
  78 0026 0134     		adds	r4, r4, #1
  79              	.LVL8:
  80              		.loc 1 53 27 discriminator 2 view .LVU15
  81 0028 E4B2     		uxtb	r4, r4
  82              	.LVL9:
  83              	.L2:
  84              		.loc 1 53 17 is_stmt 1 discriminator 1 view .LVU16
  85              		.loc 1 53 5 is_stmt 0 discriminator 1 view .LVU17
  86 002a AC42     		cmp	r4, r5
  87 002c 07D2     		bcs	.L3
  54:HADRWARE/TOUCH/ft5206.c ****     {
  55:HADRWARE/TOUCH/ft5206.c ****         ct_iic_send_byte(buf[i]);       /* 发数据 */
  88              		.loc 1 55 9 is_stmt 1 view .LVU18
  89 002e 385D     		ldrb	r0, [r7, r4]	@ zero_extendqisi2
  90 0030 FFF7FEFF 		bl	ct_iic_send_byte
  91              	.LVL10:
  56:HADRWARE/TOUCH/ft5206.c ****         ret = ct_iic_wait_ack();
  92              		.loc 1 56 9 view .LVU19
  93              		.loc 1 56 15 is_stmt 0 view .LVU20
  94 0034 FFF7FEFF 		bl	ct_iic_wait_ack
  95              	.LVL11:
  57:HADRWARE/TOUCH/ft5206.c **** 
  58:HADRWARE/TOUCH/ft5206.c ****         if (ret)break;
  96              		.loc 1 58 9 is_stmt 1 view .LVU21
  97              		.loc 1 58 12 is_stmt 0 view .LVU22
  98 0038 0646     		mov	r6, r0
  99 003a 0028     		cmp	r0, #0
 100 003c F3D0     		beq	.L6
 101              	.LVL12:
 102              	.L3:
  59:HADRWARE/TOUCH/ft5206.c ****     }
  60:HADRWARE/TOUCH/ft5206.c **** 
  61:HADRWARE/TOUCH/ft5206.c ****     ct_iic_stop();  /* 产生一个停止条件 */
 103              		.loc 1 61 5 is_stmt 1 view .LVU23
 104 003e FFF7FEFF 		bl	ct_iic_stop
 105              	.LVL13:
  62:HADRWARE/TOUCH/ft5206.c ****     return ret;
 106              		.loc 1 62 5 view .LVU24
  63:HADRWARE/TOUCH/ft5206.c **** }
 107              		.loc 1 63 1 is_stmt 0 view .LVU25
 108 0042 3046     		mov	r0, r6
ARM GAS  /tmp/ccxgooGA.s 			page 4


 109 0044 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 110              		.loc 1 63 1 view .LVU26
 111              		.cfi_endproc
 112              	.LFE126:
 114              		.section	.text.ft5206_rd_reg,"ax",%progbits
 115              		.align	1
 116              		.global	ft5206_rd_reg
 117              		.syntax unified
 118              		.thumb
 119              		.thumb_func
 120              		.fpu fpv4-sp-d16
 122              	ft5206_rd_reg:
 123              	.LVL14:
 124              	.LFB127:
  64:HADRWARE/TOUCH/ft5206.c **** 
  65:HADRWARE/TOUCH/ft5206.c **** /**
  66:HADRWARE/TOUCH/ft5206.c ****  * @brief       从FT5206读出一次数据
  67:HADRWARE/TOUCH/ft5206.c ****  * @param       reg : 起始寄存器地址
  68:HADRWARE/TOUCH/ft5206.c ****  * @param       buf : 数据缓缓存区
  69:HADRWARE/TOUCH/ft5206.c ****  * @param       len : 读数据长度
  70:HADRWARE/TOUCH/ft5206.c ****  * @retval      无
  71:HADRWARE/TOUCH/ft5206.c ****  */
  72:HADRWARE/TOUCH/ft5206.c **** void ft5206_rd_reg(uint16_t reg, uint8_t *buf, uint8_t len)
  73:HADRWARE/TOUCH/ft5206.c **** {
 125              		.loc 1 73 1 is_stmt 1 view -0
 126              		.cfi_startproc
 127              		@ args = 0, pretend = 0, frame = 0
 128              		@ frame_needed = 0, uses_anonymous_args = 0
 129              		.loc 1 73 1 is_stmt 0 view .LVU28
 130 0000 70B5     		push	{r4, r5, r6, lr}
 131              	.LCFI1:
 132              		.cfi_def_cfa_offset 16
 133              		.cfi_offset 4, -16
 134              		.cfi_offset 5, -12
 135              		.cfi_offset 6, -8
 136              		.cfi_offset 14, -4
 137 0002 0446     		mov	r4, r0
 138 0004 0E46     		mov	r6, r1
 139 0006 1546     		mov	r5, r2
  74:HADRWARE/TOUCH/ft5206.c ****     uint8_t i;
 140              		.loc 1 74 5 is_stmt 1 view .LVU29
  75:HADRWARE/TOUCH/ft5206.c ****     ct_iic_start();
 141              		.loc 1 75 5 view .LVU30
 142 0008 FFF7FEFF 		bl	ct_iic_start
 143              	.LVL15:
  76:HADRWARE/TOUCH/ft5206.c ****     ct_iic_send_byte(FT5206_CMD_WR);    /* 发送写命令 */
 144              		.loc 1 76 5 view .LVU31
 145 000c 7020     		movs	r0, #112
 146 000e FFF7FEFF 		bl	ct_iic_send_byte
 147              	.LVL16:
  77:HADRWARE/TOUCH/ft5206.c ****     ct_iic_wait_ack();
 148              		.loc 1 77 5 view .LVU32
 149 0012 FFF7FEFF 		bl	ct_iic_wait_ack
 150              	.LVL17:
  78:HADRWARE/TOUCH/ft5206.c ****     ct_iic_send_byte(reg & 0XFF);       /* 发送低8位地址 */
 151              		.loc 1 78 5 view .LVU33
 152 0016 E0B2     		uxtb	r0, r4
ARM GAS  /tmp/ccxgooGA.s 			page 5


 153 0018 FFF7FEFF 		bl	ct_iic_send_byte
 154              	.LVL18:
  79:HADRWARE/TOUCH/ft5206.c ****     ct_iic_wait_ack();
 155              		.loc 1 79 5 view .LVU34
 156 001c FFF7FEFF 		bl	ct_iic_wait_ack
 157              	.LVL19:
  80:HADRWARE/TOUCH/ft5206.c ****     ct_iic_start();
 158              		.loc 1 80 5 view .LVU35
 159 0020 FFF7FEFF 		bl	ct_iic_start
 160              	.LVL20:
  81:HADRWARE/TOUCH/ft5206.c ****     ct_iic_send_byte(FT5206_CMD_RD);    /* 发送读命令 */
 161              		.loc 1 81 5 view .LVU36
 162 0024 7120     		movs	r0, #113
 163 0026 FFF7FEFF 		bl	ct_iic_send_byte
 164              	.LVL21:
  82:HADRWARE/TOUCH/ft5206.c ****     ct_iic_wait_ack();
 165              		.loc 1 82 5 view .LVU37
 166 002a FFF7FEFF 		bl	ct_iic_wait_ack
 167              	.LVL22:
  83:HADRWARE/TOUCH/ft5206.c **** 
  84:HADRWARE/TOUCH/ft5206.c ****     for (i = 0; i < len; i++)
 168              		.loc 1 84 5 view .LVU38
 169              		.loc 1 84 12 is_stmt 0 view .LVU39
 170 002e 0024     		movs	r4, #0
 171              		.loc 1 84 5 view .LVU40
 172 0030 08E0     		b	.L8
 173              	.LVL23:
 174              	.L9:
  85:HADRWARE/TOUCH/ft5206.c ****     {
  86:HADRWARE/TOUCH/ft5206.c ****         buf[i] = ct_iic_read_byte(i == (len - 1) ? 0 : 1);  /* 发数据 */
 175              		.loc 1 86 9 is_stmt 1 discriminator 3 view .LVU41
 176              		.loc 1 86 45 is_stmt 0 discriminator 3 view .LVU42
 177 0032 681E     		subs	r0, r5, #1
 178              		.loc 1 86 18 discriminator 3 view .LVU43
 179 0034 201A     		subs	r0, r4, r0
 180 0036 18BF     		it	ne
 181 0038 0120     		movne	r0, #1
 182 003a FFF7FEFF 		bl	ct_iic_read_byte
 183              	.LVL24:
 184              		.loc 1 86 16 discriminator 3 view .LVU44
 185 003e 3055     		strb	r0, [r6, r4]
  84:HADRWARE/TOUCH/ft5206.c ****     {
 186              		.loc 1 84 26 is_stmt 1 discriminator 3 view .LVU45
  84:HADRWARE/TOUCH/ft5206.c ****     {
 187              		.loc 1 84 27 is_stmt 0 discriminator 3 view .LVU46
 188 0040 0134     		adds	r4, r4, #1
 189              	.LVL25:
  84:HADRWARE/TOUCH/ft5206.c ****     {
 190              		.loc 1 84 27 discriminator 3 view .LVU47
 191 0042 E4B2     		uxtb	r4, r4
 192              	.LVL26:
 193              	.L8:
  84:HADRWARE/TOUCH/ft5206.c ****     {
 194              		.loc 1 84 17 is_stmt 1 discriminator 1 view .LVU48
  84:HADRWARE/TOUCH/ft5206.c ****     {
 195              		.loc 1 84 5 is_stmt 0 discriminator 1 view .LVU49
 196 0044 AC42     		cmp	r4, r5
ARM GAS  /tmp/ccxgooGA.s 			page 6


 197 0046 F4D3     		bcc	.L9
  87:HADRWARE/TOUCH/ft5206.c ****     }
  88:HADRWARE/TOUCH/ft5206.c **** 
  89:HADRWARE/TOUCH/ft5206.c ****     ct_iic_stop();  /* 产生一个停止条件 */
 198              		.loc 1 89 5 is_stmt 1 view .LVU50
 199 0048 FFF7FEFF 		bl	ct_iic_stop
 200              	.LVL27:
  90:HADRWARE/TOUCH/ft5206.c **** }
 201              		.loc 1 90 1 is_stmt 0 view .LVU51
 202 004c 70BD     		pop	{r4, r5, r6, pc}
 203              		.loc 1 90 1 view .LVU52
 204              		.cfi_endproc
 205              	.LFE127:
 207              		.section	.rodata.ft5206_init.str1.4,"aMS",%progbits,1
 208              		.align	2
 209              	.LC0:
 210 0000 43545020 		.ascii	"CTP ID:%x\015\012\000"
 210      49443A25 
 210      780D0A00 
 211              		.section	.text.ft5206_init,"ax",%progbits
 212              		.align	1
 213              		.global	ft5206_init
 214              		.syntax unified
 215              		.thumb
 216              		.thumb_func
 217              		.fpu fpv4-sp-d16
 219              	ft5206_init:
 220              	.LFB128:
  91:HADRWARE/TOUCH/ft5206.c **** 
  92:HADRWARE/TOUCH/ft5206.c **** /**
  93:HADRWARE/TOUCH/ft5206.c ****  * @brief       初始化FT5206触摸屏
  94:HADRWARE/TOUCH/ft5206.c ****  * @param       无
  95:HADRWARE/TOUCH/ft5206.c ****  * @retval      0, 初始化成功; 1, 初始化失败;
  96:HADRWARE/TOUCH/ft5206.c ****  */
  97:HADRWARE/TOUCH/ft5206.c **** uint8_t ft5206_init(void)
  98:HADRWARE/TOUCH/ft5206.c **** {
 221              		.loc 1 98 1 is_stmt 1 view -0
 222              		.cfi_startproc
 223              		@ args = 0, pretend = 0, frame = 8
 224              		@ frame_needed = 0, uses_anonymous_args = 0
 225 0000 30B5     		push	{r4, r5, lr}
 226              	.LCFI2:
 227              		.cfi_def_cfa_offset 12
 228              		.cfi_offset 4, -12
 229              		.cfi_offset 5, -8
 230              		.cfi_offset 14, -4
 231 0002 85B0     		sub	sp, sp, #20
 232              	.LCFI3:
 233              		.cfi_def_cfa_offset 32
  99:HADRWARE/TOUCH/ft5206.c ****     uint8_t temp[2];
 234              		.loc 1 99 5 view .LVU54
 100:HADRWARE/TOUCH/ft5206.c **** 
 101:HADRWARE/TOUCH/ft5206.c ****     FT5206_RST_GPIO_CLK_ENABLE();   /* RST引脚时钟使能 */
 235              		.loc 1 101 5 view .LVU55
 236              		.loc 1 101 5 view .LVU56
 237 0004 374B     		ldr	r3, .L19
 238 0006 1A6B     		ldr	r2, [r3, #48]
ARM GAS  /tmp/ccxgooGA.s 			page 7


 239 0008 42F48072 		orr	r2, r2, #256
 240 000c 1A63     		str	r2, [r3, #48]
 241              		.loc 1 101 5 view .LVU57
 102:HADRWARE/TOUCH/ft5206.c ****     FT5206_INT_GPIO_CLK_ENABLE();   /* INT引脚时钟使能 */
 242              		.loc 1 102 5 view .LVU58
 243              		.loc 1 102 5 view .LVU59
 244 000e 1A6B     		ldr	r2, [r3, #48]
 245 0010 42F08002 		orr	r2, r2, #128
 246 0014 1A63     		str	r2, [r3, #48]
 247              		.loc 1 102 5 view .LVU60
 103:HADRWARE/TOUCH/ft5206.c **** 
 104:HADRWARE/TOUCH/ft5206.c ****     /* RST引脚模式设置, 推挽输出, 上拉 */
 105:HADRWARE/TOUCH/ft5206.c ****     sys_gpio_set(FT5206_RST_GPIO_PORT, FT5206_RST_GPIO_PIN,
 248              		.loc 1 105 5 view .LVU61
 249 0016 344D     		ldr	r5, .L19+4
 250 0018 0124     		movs	r4, #1
 251 001a 0194     		str	r4, [sp, #4]
 252 001c 0094     		str	r4, [sp]
 253 001e 0023     		movs	r3, #0
 254 0020 2246     		mov	r2, r4
 255 0022 4FF48071 		mov	r1, #256
 256 0026 2846     		mov	r0, r5
 257 0028 FFF7FEFF 		bl	sys_gpio_set
 258              	.LVL28:
 106:HADRWARE/TOUCH/ft5206.c ****                  SYS_GPIO_MODE_OUT, SYS_GPIO_OTYPE_PP, SYS_GPIO_SPEED_MID, SYS_GPIO_PUPD_PU);
 107:HADRWARE/TOUCH/ft5206.c **** 
 108:HADRWARE/TOUCH/ft5206.c ****     /* INT引脚模式设置, 输入模式, 上拉 */
 109:HADRWARE/TOUCH/ft5206.c ****     sys_gpio_set(FT5206_INT_GPIO_PORT, FT5206_INT_GPIO_PIN,
 259              		.loc 1 109 5 view .LVU62
 260 002c 0194     		str	r4, [sp, #4]
 261 002e 0094     		str	r4, [sp]
 262 0030 0023     		movs	r3, #0
 263 0032 1A46     		mov	r2, r3
 264 0034 8021     		movs	r1, #128
 265 0036 2D48     		ldr	r0, .L19+8
 266 0038 FFF7FEFF 		bl	sys_gpio_set
 267              	.LVL29:
 110:HADRWARE/TOUCH/ft5206.c ****                  SYS_GPIO_MODE_IN, SYS_GPIO_OTYPE_PP, SYS_GPIO_SPEED_MID, SYS_GPIO_PUPD_PU);
 111:HADRWARE/TOUCH/ft5206.c **** 
 112:HADRWARE/TOUCH/ft5206.c ****     
 113:HADRWARE/TOUCH/ft5206.c ****     ct_iic_init();      /* 初始化电容屏的I2C总线 */
 268              		.loc 1 113 5 view .LVU63
 269 003c FFF7FEFF 		bl	ct_iic_init
 270              	.LVL30:
 114:HADRWARE/TOUCH/ft5206.c ****     FT5206_RST(0);      /* 复位 */
 271              		.loc 1 114 5 view .LVU64
 272 0040 0022     		movs	r2, #0
 273 0042 4FF48071 		mov	r1, #256
 274 0046 2846     		mov	r0, r5
 275 0048 FFF7FEFF 		bl	sys_gpio_pin_set
 276              	.LVL31:
 115:HADRWARE/TOUCH/ft5206.c ****     delay_ms(20);
 277              		.loc 1 115 5 view .LVU65
 278 004c 1420     		movs	r0, #20
 279 004e FFF7FEFF 		bl	delay_ms
 280              	.LVL32:
 116:HADRWARE/TOUCH/ft5206.c ****     FT5206_RST(1);      /* 释放复位 */
ARM GAS  /tmp/ccxgooGA.s 			page 8


 281              		.loc 1 116 5 view .LVU66
 282 0052 2246     		mov	r2, r4
 283 0054 4FF48071 		mov	r1, #256
 284 0058 2846     		mov	r0, r5
 285 005a FFF7FEFF 		bl	sys_gpio_pin_set
 286              	.LVL33:
 117:HADRWARE/TOUCH/ft5206.c ****     delay_ms(50);
 287              		.loc 1 117 5 view .LVU67
 288 005e 3220     		movs	r0, #50
 289 0060 FFF7FEFF 		bl	delay_ms
 290              	.LVL34:
 118:HADRWARE/TOUCH/ft5206.c ****     temp[0] = 0;
 291              		.loc 1 118 5 view .LVU68
 292              		.loc 1 118 13 is_stmt 0 view .LVU69
 293 0064 0020     		movs	r0, #0
 294 0066 8DF80C00 		strb	r0, [sp, #12]
 119:HADRWARE/TOUCH/ft5206.c ****     ft5206_wr_reg(FT5206_DEVIDE_MODE, temp, 1); /* 进入正常操作模式 */
 295              		.loc 1 119 5 is_stmt 1 view .LVU70
 296 006a 2246     		mov	r2, r4
 297 006c 03A9     		add	r1, sp, #12
 298 006e FFF7FEFF 		bl	ft5206_wr_reg
 299              	.LVL35:
 120:HADRWARE/TOUCH/ft5206.c ****     ft5206_wr_reg(FT5206_ID_G_MODE, temp, 1);   /* 查询模式 */
 300              		.loc 1 120 5 view .LVU71
 301 0072 2246     		mov	r2, r4
 302 0074 03A9     		add	r1, sp, #12
 303 0076 A420     		movs	r0, #164
 304 0078 FFF7FEFF 		bl	ft5206_wr_reg
 305              	.LVL36:
 121:HADRWARE/TOUCH/ft5206.c ****     temp[0] = 22;                               /* 触摸有效值，22，越小越灵敏 */
 306              		.loc 1 121 5 view .LVU72
 307              		.loc 1 121 13 is_stmt 0 view .LVU73
 308 007c 1623     		movs	r3, #22
 309 007e 8DF80C30 		strb	r3, [sp, #12]
 122:HADRWARE/TOUCH/ft5206.c ****     ft5206_wr_reg(FT5206_ID_G_THGROUP, temp, 1);/* 设置触摸有效值 */
 310              		.loc 1 122 5 is_stmt 1 view .LVU74
 311 0082 2246     		mov	r2, r4
 312 0084 03A9     		add	r1, sp, #12
 313 0086 8020     		movs	r0, #128
 314 0088 FFF7FEFF 		bl	ft5206_wr_reg
 315              	.LVL37:
 123:HADRWARE/TOUCH/ft5206.c ****     temp[0] = 12;                               /* 激活周期，不能小于12，最大14 */
 316              		.loc 1 123 5 view .LVU75
 317              		.loc 1 123 13 is_stmt 0 view .LVU76
 318 008c 0C23     		movs	r3, #12
 319 008e 8DF80C30 		strb	r3, [sp, #12]
 124:HADRWARE/TOUCH/ft5206.c ****     ft5206_wr_reg(FT5206_ID_G_PERIODACTIVE, temp, 1);
 320              		.loc 1 124 5 is_stmt 1 view .LVU77
 321 0092 2246     		mov	r2, r4
 322 0094 0DEB0301 		add	r1, sp, r3
 323 0098 8820     		movs	r0, #136
 324 009a FFF7FEFF 		bl	ft5206_wr_reg
 325              	.LVL38:
 125:HADRWARE/TOUCH/ft5206.c ****     
 126:HADRWARE/TOUCH/ft5206.c ****     /* 读取版本号，参考值：0x3003 */
 127:HADRWARE/TOUCH/ft5206.c ****     ft5206_rd_reg(FT5206_ID_G_LIB_VERSION, &temp[0], 2);
 326              		.loc 1 127 5 view .LVU78
ARM GAS  /tmp/ccxgooGA.s 			page 9


 327 009e 0222     		movs	r2, #2
 328 00a0 03A9     		add	r1, sp, #12
 329 00a2 A120     		movs	r0, #161
 330 00a4 FFF7FEFF 		bl	ft5206_rd_reg
 331              	.LVL39:
 128:HADRWARE/TOUCH/ft5206.c **** 
 129:HADRWARE/TOUCH/ft5206.c ****     if ((temp[0] == 0X30 && temp[1] == 0X03) || temp[1] == 0X01 || temp[1] == 0X02 || (temp[0] == 0
 332              		.loc 1 129 5 view .LVU79
 333              		.loc 1 129 14 is_stmt 0 view .LVU80
 334 00a8 9DF80C30 		ldrb	r3, [sp, #12]	@ zero_extendqisi2
 335              		.loc 1 129 8 view .LVU81
 336 00ac 302B     		cmp	r3, #48
 337 00ae 09D0     		beq	.L18
 338              	.L12:
 339              		.loc 1 129 53 discriminator 3 view .LVU82
 340 00b0 9DF80D20 		ldrb	r2, [sp, #13]	@ zero_extendqisi2
 341              		.loc 1 129 46 discriminator 3 view .LVU83
 342 00b4 012A     		cmp	r2, #1
 343 00b6 09D0     		beq	.L13
 344              		.loc 1 129 65 discriminator 4 view .LVU84
 345 00b8 022A     		cmp	r2, #2
 346 00ba 07D0     		beq	.L13
 347              		.loc 1 129 84 discriminator 5 view .LVU85
 348 00bc 83B9     		cbnz	r3, .L15
 349              		.loc 1 129 103 discriminator 6 view .LVU86
 350 00be 2AB1     		cbz	r2, .L13
 130:HADRWARE/TOUCH/ft5206.c ****     {
 131:HADRWARE/TOUCH/ft5206.c ****         printf("CTP ID:%x\r\n", ((uint16_t)temp[0] << 8) + temp[1]);
 132:HADRWARE/TOUCH/ft5206.c ****         return 0;
 133:HADRWARE/TOUCH/ft5206.c ****     }
 134:HADRWARE/TOUCH/ft5206.c **** 
 135:HADRWARE/TOUCH/ft5206.c ****     return 1;
 351              		.loc 1 135 12 view .LVU87
 352 00c0 0120     		movs	r0, #1
 353 00c2 0BE0     		b	.L14
 354              	.L18:
 129:HADRWARE/TOUCH/ft5206.c ****     {
 355              		.loc 1 129 33 discriminator 1 view .LVU88
 356 00c4 9DF80D20 		ldrb	r2, [sp, #13]	@ zero_extendqisi2
 129:HADRWARE/TOUCH/ft5206.c ****     {
 357              		.loc 1 129 26 discriminator 1 view .LVU89
 358 00c8 032A     		cmp	r2, #3
 359 00ca F1D1     		bne	.L12
 360              	.L13:
 131:HADRWARE/TOUCH/ft5206.c ****         return 0;
 361              		.loc 1 131 9 is_stmt 1 view .LVU90
 131:HADRWARE/TOUCH/ft5206.c ****         return 0;
 362              		.loc 1 131 64 is_stmt 0 view .LVU91
 363 00cc 9DF80D10 		ldrb	r1, [sp, #13]	@ zero_extendqisi2
 131:HADRWARE/TOUCH/ft5206.c ****         return 0;
 364              		.loc 1 131 9 view .LVU92
 365 00d0 01EB0321 		add	r1, r1, r3, lsl #8
 366 00d4 0648     		ldr	r0, .L19+12
 367 00d6 FFF7FEFF 		bl	printf
 368              	.LVL40:
 132:HADRWARE/TOUCH/ft5206.c ****     }
 369              		.loc 1 132 9 is_stmt 1 view .LVU93
ARM GAS  /tmp/ccxgooGA.s 			page 10


 132:HADRWARE/TOUCH/ft5206.c ****     }
 370              		.loc 1 132 16 is_stmt 0 view .LVU94
 371 00da 0020     		movs	r0, #0
 372              	.L14:
 136:HADRWARE/TOUCH/ft5206.c **** }
 373              		.loc 1 136 1 view .LVU95
 374 00dc 05B0     		add	sp, sp, #20
 375              	.LCFI4:
 376              		.cfi_remember_state
 377              		.cfi_def_cfa_offset 12
 378              		@ sp needed
 379 00de 30BD     		pop	{r4, r5, pc}
 380              	.L15:
 381              	.LCFI5:
 382              		.cfi_restore_state
 135:HADRWARE/TOUCH/ft5206.c **** }
 383              		.loc 1 135 12 view .LVU96
 384 00e0 0120     		movs	r0, #1
 385 00e2 FBE7     		b	.L14
 386              	.L20:
 387              		.align	2
 388              	.L19:
 389 00e4 00380240 		.word	1073887232
 390 00e8 00200240 		.word	1073881088
 391 00ec 001C0240 		.word	1073880064
 392 00f0 00000000 		.word	.LC0
 393              		.cfi_endproc
 394              	.LFE128:
 396              		.section	.text.ft5206_scan,"ax",%progbits
 397              		.align	1
 398              		.global	ft5206_scan
 399              		.syntax unified
 400              		.thumb
 401              		.thumb_func
 402              		.fpu fpv4-sp-d16
 404              	ft5206_scan:
 405              	.LVL41:
 406              	.LFB129:
 137:HADRWARE/TOUCH/ft5206.c **** 
 138:HADRWARE/TOUCH/ft5206.c **** /* FT5206 5个触摸点 对应的寄存器表 */
 139:HADRWARE/TOUCH/ft5206.c **** const uint16_t FT5206_TPX_TBL[5] = {FT5206_TP1_REG, FT5206_TP2_REG, FT5206_TP3_REG, FT5206_TP4_REG,
 140:HADRWARE/TOUCH/ft5206.c **** 
 141:HADRWARE/TOUCH/ft5206.c **** /**
 142:HADRWARE/TOUCH/ft5206.c ****  * @brief       扫描触摸屏(采用查询方式)
 143:HADRWARE/TOUCH/ft5206.c ****  * @param       mode : 电容屏未用到次参数, 为了兼容电阻屏
 144:HADRWARE/TOUCH/ft5206.c ****  * @retval      当前触屏状态
 145:HADRWARE/TOUCH/ft5206.c ****  *   @arg       0, 触屏无触摸; 
 146:HADRWARE/TOUCH/ft5206.c ****  *   @arg       1, 触屏有触摸;
 147:HADRWARE/TOUCH/ft5206.c ****  */
 148:HADRWARE/TOUCH/ft5206.c **** uint8_t ft5206_scan(uint8_t mode)
 149:HADRWARE/TOUCH/ft5206.c **** {
 407              		.loc 1 149 1 is_stmt 1 view -0
 408              		.cfi_startproc
 409              		@ args = 0, pretend = 0, frame = 8
 410              		@ frame_needed = 0, uses_anonymous_args = 0
 411              		.loc 1 149 1 is_stmt 0 view .LVU98
 412 0000 30B5     		push	{r4, r5, lr}
ARM GAS  /tmp/ccxgooGA.s 			page 11


 413              	.LCFI6:
 414              		.cfi_def_cfa_offset 12
 415              		.cfi_offset 4, -12
 416              		.cfi_offset 5, -8
 417              		.cfi_offset 14, -4
 418 0002 83B0     		sub	sp, sp, #12
 419              	.LCFI7:
 420              		.cfi_def_cfa_offset 24
 150:HADRWARE/TOUCH/ft5206.c ****     uint8_t sta = 0;
 421              		.loc 1 150 5 is_stmt 1 view .LVU99
 422              		.loc 1 150 13 is_stmt 0 view .LVU100
 423 0004 0023     		movs	r3, #0
 424 0006 8DF80730 		strb	r3, [sp, #7]
 151:HADRWARE/TOUCH/ft5206.c ****     uint8_t buf[4];
 425              		.loc 1 151 5 is_stmt 1 view .LVU101
 152:HADRWARE/TOUCH/ft5206.c ****     uint8_t i = 0;
 426              		.loc 1 152 5 view .LVU102
 427              	.LVL42:
 153:HADRWARE/TOUCH/ft5206.c ****     uint8_t res = 0;
 428              		.loc 1 153 5 view .LVU103
 154:HADRWARE/TOUCH/ft5206.c ****     uint16_t temp;
 429              		.loc 1 154 5 view .LVU104
 155:HADRWARE/TOUCH/ft5206.c ****     static uint8_t t = 0;   /* 控制查询间隔,从而降低CPU占用率 */
 430              		.loc 1 155 5 view .LVU105
 156:HADRWARE/TOUCH/ft5206.c ****     
 157:HADRWARE/TOUCH/ft5206.c ****     t++;
 431              		.loc 1 157 5 view .LVU106
 432              		.loc 1 157 6 is_stmt 0 view .LVU107
 433 000a 5F4B     		ldr	r3, .L39
 434 000c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 435 000e 0132     		adds	r2, r2, #1
 436 0010 D2B2     		uxtb	r2, r2
 437 0012 1A70     		strb	r2, [r3]
 158:HADRWARE/TOUCH/ft5206.c ****     
 159:HADRWARE/TOUCH/ft5206.c ****     if ((t % 10) == 0 || t < 10)   /* 空闲时,每进入10次CTP_Scan函数才检测1次,从而节省CPU使用率 */
 438              		.loc 1 159 5 is_stmt 1 view .LVU108
 439              		.loc 1 159 18 is_stmt 0 view .LVU109
 440 0014 5D4B     		ldr	r3, .L39+4
 441 0016 A3FB0213 		umull	r1, r3, r3, r2
 442 001a DB08     		lsrs	r3, r3, #3
 443 001c 03EB8303 		add	r3, r3, r3, lsl #2
 444 0020 5900     		lsls	r1, r3, #1
 445 0022 511A     		subs	r1, r2, r1
 446              		.loc 1 159 8 view .LVU110
 447 0024 11F0FF0F 		tst	r1, #255
 448 0028 02D0     		beq	.L22
 449              		.loc 1 159 23 discriminator 1 view .LVU111
 450 002a 092A     		cmp	r2, #9
 451 002c 00F28A80 		bhi	.L33
 452              	.L22:
 160:HADRWARE/TOUCH/ft5206.c ****     {
 161:HADRWARE/TOUCH/ft5206.c ****         ft5206_rd_reg(FT5206_REG_NUM_FINGER, &sta, 1);  /* 读取触摸点的状态 */
 453              		.loc 1 161 9 is_stmt 1 view .LVU112
 454 0030 0122     		movs	r2, #1
 455 0032 0DF10701 		add	r1, sp, #7
 456 0036 0220     		movs	r0, #2
 457              	.LVL43:
ARM GAS  /tmp/ccxgooGA.s 			page 12


 458              		.loc 1 161 9 is_stmt 0 view .LVU113
 459 0038 FFF7FEFF 		bl	ft5206_rd_reg
 460              	.LVL44:
 162:HADRWARE/TOUCH/ft5206.c **** 
 163:HADRWARE/TOUCH/ft5206.c ****         if ((sta & 0XF) && ((sta & 0XF) < 6))
 461              		.loc 1 163 9 is_stmt 1 view .LVU114
 462              		.loc 1 163 18 is_stmt 0 view .LVU115
 463 003c 9DF80700 		ldrb	r0, [sp, #7]	@ zero_extendqisi2
 464 0040 00F00F00 		and	r0, r0, #15
 465              		.loc 1 163 12 view .LVU116
 466 0044 0028     		cmp	r0, #0
 467 0046 7ED0     		beq	.L23
 468              		.loc 1 163 25 discriminator 1 view .LVU117
 469 0048 0528     		cmp	r0, #5
 470 004a 01D9     		bls	.L36
 153:HADRWARE/TOUCH/ft5206.c ****     uint16_t temp;
 471              		.loc 1 153 13 view .LVU118
 472 004c 0020     		movs	r0, #0
 473 004e 7AE0     		b	.L23
 474              	.L36:
 164:HADRWARE/TOUCH/ft5206.c ****         {
 165:HADRWARE/TOUCH/ft5206.c ****             temp = 0XFFFF << (sta & 0XF);           /* 将点的个数转换为1的位数,匹配tp_dev.sta定义 *
 475              		.loc 1 165 13 is_stmt 1 view .LVU119
 476              		.loc 1 165 27 is_stmt 0 view .LVU120
 477 0050 4FF6FF73 		movw	r3, #65535
 478 0054 8340     		lsls	r3, r3, r0
 479              	.LVL45:
 166:HADRWARE/TOUCH/ft5206.c ****             tp_dev.sta = (~temp) | TP_PRES_DOWN | TP_CATH_PRES;
 480              		.loc 1 166 13 is_stmt 1 view .LVU121
 481              		.loc 1 166 49 is_stmt 0 view .LVU122
 482 0056 DB43     		mvns	r3, r3
 483              	.LVL46:
 484              		.loc 1 166 49 view .LVU123
 485 0058 6FEA8343 		mvn	r3, r3, lsl #18
 486              	.LVL47:
 487              		.loc 1 166 49 view .LVU124
 488 005c 6FEA9343 		mvn	r3, r3, lsr #18
 489              		.loc 1 166 24 view .LVU125
 490 0060 4B4A     		ldr	r2, .L39+8
 491 0062 9386     		strh	r3, [r2, #52]	@ movhi
 167:HADRWARE/TOUCH/ft5206.c **** 
 168:HADRWARE/TOUCH/ft5206.c ****             delay_ms(4);                            /* 必要的延时，否则老是认为有按键按下 */
 492              		.loc 1 168 13 is_stmt 1 view .LVU126
 493 0064 0420     		movs	r0, #4
 494              	.LVL48:
 495              		.loc 1 168 13 is_stmt 0 view .LVU127
 496 0066 FFF7FEFF 		bl	delay_ms
 497              	.LVL49:
 169:HADRWARE/TOUCH/ft5206.c ****             
 170:HADRWARE/TOUCH/ft5206.c ****             for (i = 0; i < 5; i++)
 498              		.loc 1 170 13 is_stmt 1 view .LVU128
 499              		.loc 1 170 20 is_stmt 0 view .LVU129
 500 006a 0024     		movs	r4, #0
 501              		.loc 1 170 13 view .LVU130
 502 006c 2DE0     		b	.L24
 503              	.LVL50:
 504              	.L26:
ARM GAS  /tmp/ccxgooGA.s 			page 13


 171:HADRWARE/TOUCH/ft5206.c ****             {
 172:HADRWARE/TOUCH/ft5206.c ****                 if (tp_dev.sta & (1 << i))          /* 触摸有效? */
 173:HADRWARE/TOUCH/ft5206.c ****                 {
 174:HADRWARE/TOUCH/ft5206.c ****                     ft5206_rd_reg(FT5206_TPX_TBL[i], buf, 4);   /* 读取XY坐标值 */
 175:HADRWARE/TOUCH/ft5206.c **** 
 176:HADRWARE/TOUCH/ft5206.c ****                     if (tp_dev.touchtype & 0X01)    /* 横屏 */
 177:HADRWARE/TOUCH/ft5206.c ****                     {
 178:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.y[i] = ((uint16_t)(buf[0] & 0X0F) << 8) + buf[1];
 179:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 180:HADRWARE/TOUCH/ft5206.c ****                     }
 181:HADRWARE/TOUCH/ft5206.c ****                     else
 182:HADRWARE/TOUCH/ft5206.c ****                     {
 183:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.x[i] = lcddev.width - (((uint16_t)(buf[0] & 0X0F) << 8) + buf[1]);
 505              		.loc 1 183 25 is_stmt 1 view .LVU131
 506              		.loc 1 183 45 is_stmt 0 view .LVU132
 507 006e 494B     		ldr	r3, .L39+12
 508 0070 1A88     		ldrh	r2, [r3]
 509              		.loc 1 183 70 view .LVU133
 510 0072 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 511              		.loc 1 183 82 view .LVU134
 512 0076 1B02     		lsls	r3, r3, #8
 513 0078 03F47063 		and	r3, r3, #3840
 514              		.loc 1 183 93 view .LVU135
 515 007c 9DF80110 		ldrb	r1, [sp, #1]	@ zero_extendqisi2
 516              		.loc 1 183 88 view .LVU136
 517 0080 0B44     		add	r3, r3, r1
 518              		.loc 1 183 52 view .LVU137
 519 0082 D31A     		subs	r3, r2, r3
 520              		.loc 1 183 37 view .LVU138
 521 0084 4249     		ldr	r1, .L39+8
 522 0086 221D     		adds	r2, r4, #4
 523 0088 01EB4202 		add	r2, r1, r2, lsl #1
 524 008c 9380     		strh	r3, [r2, #4]	@ movhi
 184:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.y[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 525              		.loc 1 184 25 is_stmt 1 view .LVU139
 526              		.loc 1 184 54 is_stmt 0 view .LVU140
 527 008e 9DF80230 		ldrb	r3, [sp, #2]	@ zero_extendqisi2
 528              		.loc 1 184 66 view .LVU141
 529 0092 1B02     		lsls	r3, r3, #8
 530 0094 03F47063 		and	r3, r3, #3840
 531              		.loc 1 184 77 view .LVU142
 532 0098 9DF80320 		ldrb	r2, [sp, #3]	@ zero_extendqisi2
 533              		.loc 1 184 72 view .LVU143
 534 009c 1344     		add	r3, r3, r2
 535              		.loc 1 184 37 view .LVU144
 536 009e 04F11002 		add	r2, r4, #16
 537 00a2 21F81230 		strh	r3, [r1, r2, lsl #1]	@ movhi
 538              	.L27:
 185:HADRWARE/TOUCH/ft5206.c ****                     }
 186:HADRWARE/TOUCH/ft5206.c **** 
 187:HADRWARE/TOUCH/ft5206.c ****                     if ((buf[0] & 0XF0) != 0X80)tp_dev.x[i] = tp_dev.y[i] = 0; /* 必须是contact事件
 539              		.loc 1 187 21 is_stmt 1 view .LVU145
 540              		.loc 1 187 29 is_stmt 0 view .LVU146
 541 00a6 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 542              		.loc 1 187 24 view .LVU147
 543 00aa 03F0F003 		and	r3, r3, #240
 544 00ae 802B     		cmp	r3, #128
ARM GAS  /tmp/ccxgooGA.s 			page 14


 545 00b0 09D0     		beq	.L25
 546              		.loc 1 187 49 is_stmt 1 discriminator 1 view .LVU148
 547              		.loc 1 187 75 is_stmt 0 discriminator 1 view .LVU149
 548 00b2 374A     		ldr	r2, .L39+8
 549 00b4 05F11003 		add	r3, r5, #16
 550 00b8 0021     		movs	r1, #0
 551 00ba 22F81310 		strh	r1, [r2, r3, lsl #1]	@ movhi
 552              		.loc 1 187 61 discriminator 1 view .LVU150
 553 00be 2B1D     		adds	r3, r5, #4
 554 00c0 02EB4303 		add	r3, r2, r3, lsl #1
 555 00c4 9980     		strh	r1, [r3, #4]	@ movhi
 556              	.L25:
 170:HADRWARE/TOUCH/ft5206.c ****             {
 557              		.loc 1 170 32 is_stmt 1 discriminator 2 view .LVU151
 170:HADRWARE/TOUCH/ft5206.c ****             {
 558              		.loc 1 170 33 is_stmt 0 discriminator 2 view .LVU152
 559 00c6 0134     		adds	r4, r4, #1
 560              	.LVL51:
 170:HADRWARE/TOUCH/ft5206.c ****             {
 561              		.loc 1 170 33 discriminator 2 view .LVU153
 562 00c8 E4B2     		uxtb	r4, r4
 563              	.LVL52:
 564              	.L24:
 170:HADRWARE/TOUCH/ft5206.c ****             {
 565              		.loc 1 170 25 is_stmt 1 discriminator 1 view .LVU154
 170:HADRWARE/TOUCH/ft5206.c ****             {
 566              		.loc 1 170 13 is_stmt 0 discriminator 1 view .LVU155
 567 00ca 042C     		cmp	r4, #4
 568 00cc 2DD8     		bhi	.L37
 172:HADRWARE/TOUCH/ft5206.c ****                 {
 569              		.loc 1 172 17 is_stmt 1 view .LVU156
 172:HADRWARE/TOUCH/ft5206.c ****                 {
 570              		.loc 1 172 27 is_stmt 0 view .LVU157
 571 00ce 304B     		ldr	r3, .L39+8
 572 00d0 9B8E     		ldrh	r3, [r3, #52]
 172:HADRWARE/TOUCH/ft5206.c ****                 {
 573              		.loc 1 172 21 view .LVU158
 574 00d2 2546     		mov	r5, r4
 575 00d4 2341     		asrs	r3, r3, r4
 172:HADRWARE/TOUCH/ft5206.c ****                 {
 576              		.loc 1 172 20 view .LVU159
 577 00d6 13F0010F 		tst	r3, #1
 578 00da F4D0     		beq	.L25
 174:HADRWARE/TOUCH/ft5206.c **** 
 579              		.loc 1 174 21 is_stmt 1 view .LVU160
 580 00dc 0422     		movs	r2, #4
 581 00de 6946     		mov	r1, sp
 582 00e0 2D4B     		ldr	r3, .L39+16
 583 00e2 33F81400 		ldrh	r0, [r3, r4, lsl #1]
 584 00e6 FFF7FEFF 		bl	ft5206_rd_reg
 585              	.LVL53:
 176:HADRWARE/TOUCH/ft5206.c ****                     {
 586              		.loc 1 176 21 view .LVU161
 176:HADRWARE/TOUCH/ft5206.c ****                     {
 587              		.loc 1 176 31 is_stmt 0 view .LVU162
 588 00ea 294B     		ldr	r3, .L39+8
 589 00ec 93F84430 		ldrb	r3, [r3, #68]	@ zero_extendqisi2
ARM GAS  /tmp/ccxgooGA.s 			page 15


 176:HADRWARE/TOUCH/ft5206.c ****                     {
 590              		.loc 1 176 24 view .LVU163
 591 00f0 13F0010F 		tst	r3, #1
 592 00f4 BBD0     		beq	.L26
 178:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 593              		.loc 1 178 25 is_stmt 1 view .LVU164
 178:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 594              		.loc 1 178 54 is_stmt 0 view .LVU165
 595 00f6 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 178:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 596              		.loc 1 178 66 view .LVU166
 597 00fa 1B02     		lsls	r3, r3, #8
 598 00fc 03F47063 		and	r3, r3, #3840
 178:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 599              		.loc 1 178 77 view .LVU167
 600 0100 9DF80120 		ldrb	r2, [sp, #1]	@ zero_extendqisi2
 178:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 601              		.loc 1 178 72 view .LVU168
 602 0104 1344     		add	r3, r3, r2
 178:HADRWARE/TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 603              		.loc 1 178 37 view .LVU169
 604 0106 224A     		ldr	r2, .L39+8
 605 0108 04F11001 		add	r1, r4, #16
 606 010c 22F81130 		strh	r3, [r2, r1, lsl #1]	@ movhi
 179:HADRWARE/TOUCH/ft5206.c ****                     }
 607              		.loc 1 179 25 is_stmt 1 view .LVU170
 179:HADRWARE/TOUCH/ft5206.c ****                     }
 608              		.loc 1 179 54 is_stmt 0 view .LVU171
 609 0110 9DF80230 		ldrb	r3, [sp, #2]	@ zero_extendqisi2
 179:HADRWARE/TOUCH/ft5206.c ****                     }
 610              		.loc 1 179 66 view .LVU172
 611 0114 1B02     		lsls	r3, r3, #8
 612 0116 03F47063 		and	r3, r3, #3840
 179:HADRWARE/TOUCH/ft5206.c ****                     }
 613              		.loc 1 179 77 view .LVU173
 614 011a 9DF80310 		ldrb	r1, [sp, #3]	@ zero_extendqisi2
 179:HADRWARE/TOUCH/ft5206.c ****                     }
 615              		.loc 1 179 72 view .LVU174
 616 011e 0B44     		add	r3, r3, r1
 179:HADRWARE/TOUCH/ft5206.c ****                     }
 617              		.loc 1 179 37 view .LVU175
 618 0120 211D     		adds	r1, r4, #4
 619 0122 02EB4102 		add	r2, r2, r1, lsl #1
 620 0126 9380     		strh	r3, [r2, #4]	@ movhi
 621 0128 BDE7     		b	.L27
 622              	.L37:
 188:HADRWARE/TOUCH/ft5206.c **** 
 189:HADRWARE/TOUCH/ft5206.c ****                     //printf("x[%d]:%d,y[%d]:%d\r\n", i, tp_dev.x[i], i, tp_dev.y[i]);
 190:HADRWARE/TOUCH/ft5206.c ****                 }
 191:HADRWARE/TOUCH/ft5206.c ****             }
 192:HADRWARE/TOUCH/ft5206.c **** 
 193:HADRWARE/TOUCH/ft5206.c ****             res = 1;
 623              		.loc 1 193 13 is_stmt 1 view .LVU176
 624              	.LVL54:
 194:HADRWARE/TOUCH/ft5206.c **** 
 195:HADRWARE/TOUCH/ft5206.c ****             if (tp_dev.x[0] == 0 && tp_dev.y[0] == 0)sta = 0;   /* 读到的数据都是0,则忽略此次数据 *
 625              		.loc 1 195 13 view .LVU177
ARM GAS  /tmp/ccxgooGA.s 			page 16


 626              		.loc 1 195 25 is_stmt 0 view .LVU178
 627 012a 194B     		ldr	r3, .L39+8
 628 012c 9B89     		ldrh	r3, [r3, #12]
 629              		.loc 1 195 16 view .LVU179
 630 012e 23B9     		cbnz	r3, .L29
 631              		.loc 1 195 45 discriminator 1 view .LVU180
 632 0130 174B     		ldr	r3, .L39+8
 633 0132 1B8C     		ldrh	r3, [r3, #32]
 634              		.loc 1 195 34 discriminator 1 view .LVU181
 635 0134 0BB9     		cbnz	r3, .L29
 636              		.loc 1 195 54 is_stmt 1 discriminator 2 view .LVU182
 637              		.loc 1 195 58 is_stmt 0 discriminator 2 view .LVU183
 638 0136 8DF80730 		strb	r3, [sp, #7]
 639              	.L29:
 196:HADRWARE/TOUCH/ft5206.c **** 
 197:HADRWARE/TOUCH/ft5206.c ****             t = 0;  /* 触发一次,则会最少连续监测10次,从而提高命中率 */
 640              		.loc 1 197 13 is_stmt 1 view .LVU184
 641              		.loc 1 197 15 is_stmt 0 view .LVU185
 642 013a 134B     		ldr	r3, .L39
 643 013c 0022     		movs	r2, #0
 644 013e 1A70     		strb	r2, [r3]
 193:HADRWARE/TOUCH/ft5206.c **** 
 645              		.loc 1 193 17 view .LVU186
 646 0140 0120     		movs	r0, #1
 647 0142 00E0     		b	.L23
 648              	.LVL55:
 649              	.L33:
 153:HADRWARE/TOUCH/ft5206.c ****     uint16_t temp;
 650              		.loc 1 153 13 view .LVU187
 651 0144 0020     		movs	r0, #0
 652              	.LVL56:
 653              	.L23:
 198:HADRWARE/TOUCH/ft5206.c ****         }
 199:HADRWARE/TOUCH/ft5206.c ****     }
 200:HADRWARE/TOUCH/ft5206.c **** 
 201:HADRWARE/TOUCH/ft5206.c ****     if ((sta & 0X1F) == 0)  /* 无触摸点按下 */
 654              		.loc 1 201 5 is_stmt 1 view .LVU188
 655              		.loc 1 201 14 is_stmt 0 view .LVU189
 656 0146 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 657              		.loc 1 201 8 view .LVU190
 658 014a 13F01F0F 		tst	r3, #31
 659 014e 0DD1     		bne	.L30
 202:HADRWARE/TOUCH/ft5206.c ****     {
 203:HADRWARE/TOUCH/ft5206.c ****         if (tp_dev.sta & TP_PRES_DOWN)      /* 之前是被按下的 */
 660              		.loc 1 203 9 is_stmt 1 view .LVU191
 661              		.loc 1 203 19 is_stmt 0 view .LVU192
 662 0150 0F4A     		ldr	r2, .L39+8
 663 0152 938E     		ldrh	r3, [r2, #52]
 664              		.loc 1 203 13 view .LVU193
 665 0154 B2F93420 		ldrsh	r2, [r2, #52]
 666              		.loc 1 203 12 view .LVU194
 667 0158 002A     		cmp	r2, #0
 668 015a 10DB     		blt	.L38
 204:HADRWARE/TOUCH/ft5206.c ****         {
 205:HADRWARE/TOUCH/ft5206.c ****             tp_dev.sta &= ~TP_PRES_DOWN;    /* 标记按键松开 */
 206:HADRWARE/TOUCH/ft5206.c ****         }
 207:HADRWARE/TOUCH/ft5206.c ****         else    /* 之前就没有被按下 */
ARM GAS  /tmp/ccxgooGA.s 			page 17


 208:HADRWARE/TOUCH/ft5206.c ****         {
 209:HADRWARE/TOUCH/ft5206.c ****             tp_dev.x[0] = 0xffff;
 669              		.loc 1 209 13 is_stmt 1 view .LVU195
 670              		.loc 1 209 25 is_stmt 0 view .LVU196
 671 015c 0C4A     		ldr	r2, .L39+8
 672 015e 4FF6FF71 		movw	r1, #65535
 673 0162 9181     		strh	r1, [r2, #12]	@ movhi
 210:HADRWARE/TOUCH/ft5206.c ****             tp_dev.y[0] = 0xffff;
 674              		.loc 1 210 13 is_stmt 1 view .LVU197
 675              		.loc 1 210 25 is_stmt 0 view .LVU198
 676 0164 1184     		strh	r1, [r2, #32]	@ movhi
 211:HADRWARE/TOUCH/ft5206.c ****             tp_dev.sta &= 0XE000;           /* 清除点有效标记 */
 677              		.loc 1 211 13 is_stmt 1 view .LVU199
 678              		.loc 1 211 24 is_stmt 0 view .LVU200
 679 0166 03F46043 		and	r3, r3, #57344
 680 016a 9386     		strh	r3, [r2, #52]	@ movhi
 681              	.L30:
 212:HADRWARE/TOUCH/ft5206.c ****         }
 213:HADRWARE/TOUCH/ft5206.c ****     }
 214:HADRWARE/TOUCH/ft5206.c **** 
 215:HADRWARE/TOUCH/ft5206.c ****     if (t > 240)t = 10; /* 重新从10开始计数 */
 682              		.loc 1 215 5 is_stmt 1 view .LVU201
 683              		.loc 1 215 11 is_stmt 0 view .LVU202
 684 016c 064B     		ldr	r3, .L39
 685 016e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 686              		.loc 1 215 8 view .LVU203
 687 0170 F02B     		cmp	r3, #240
 688 0172 02D9     		bls	.L32
 689              		.loc 1 215 17 is_stmt 1 discriminator 1 view .LVU204
 690              		.loc 1 215 19 is_stmt 0 discriminator 1 view .LVU205
 691 0174 044B     		ldr	r3, .L39
 692 0176 0A22     		movs	r2, #10
 693 0178 1A70     		strb	r2, [r3]
 694              	.L32:
 216:HADRWARE/TOUCH/ft5206.c **** 
 217:HADRWARE/TOUCH/ft5206.c ****     return res;
 695              		.loc 1 217 5 is_stmt 1 view .LVU206
 218:HADRWARE/TOUCH/ft5206.c **** }
 696              		.loc 1 218 1 is_stmt 0 view .LVU207
 697 017a 03B0     		add	sp, sp, #12
 698              	.LCFI8:
 699              		.cfi_remember_state
 700              		.cfi_def_cfa_offset 12
 701              		@ sp needed
 702 017c 30BD     		pop	{r4, r5, pc}
 703              	.L38:
 704              	.LCFI9:
 705              		.cfi_restore_state
 205:HADRWARE/TOUCH/ft5206.c ****         }
 706              		.loc 1 205 13 is_stmt 1 view .LVU208
 205:HADRWARE/TOUCH/ft5206.c ****         }
 707              		.loc 1 205 24 is_stmt 0 view .LVU209
 708 017e C3F30E03 		ubfx	r3, r3, #0, #15
 709 0182 034A     		ldr	r2, .L39+8
 710 0184 9386     		strh	r3, [r2, #52]	@ movhi
 711 0186 F1E7     		b	.L30
 712              	.L40:
ARM GAS  /tmp/ccxgooGA.s 			page 18


 713              		.align	2
 714              	.L39:
 715 0188 00000000 		.word	.LANCHOR0
 716 018c CDCCCCCC 		.word	-858993459
 717 0190 00000000 		.word	tp_dev
 718 0194 00000000 		.word	lcddev
 719 0198 00000000 		.word	.LANCHOR1
 720              		.cfi_endproc
 721              	.LFE129:
 723              		.global	FT5206_TPX_TBL
 724              		.section	.bss.t.0,"aw",%nobits
 725              		.set	.LANCHOR0,. + 0
 728              	t.0:
 729 0000 00       		.space	1
 730              		.section	.rodata.FT5206_TPX_TBL,"a"
 731              		.align	2
 732              		.set	.LANCHOR1,. + 0
 735              	FT5206_TPX_TBL:
 736 0000 0300     		.short	3
 737 0002 0900     		.short	9
 738 0004 0F00     		.short	15
 739 0006 1500     		.short	21
 740 0008 1B00     		.short	27
 741              		.text
 742              	.Letext0:
 743              		.file 2 "/home/ktkuri/arm-gcc-tools/arm-none-eabi/include/machine/_default_types.h"
 744              		.file 3 "/home/ktkuri/arm-gcc-tools/arm-none-eabi/include/sys/_stdint.h"
 745              		.file 4 "Libraries/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 746              		.file 5 "HADRWARE/TOUCH/touch.h"
 747              		.file 6 "HADRWARE/LCD/lcd.h"
 748              		.file 7 "SYSTEM/delay/delay.h"
 749              		.file 8 "SYSTEM/sys/sys.h"
 750              		.file 9 "HADRWARE/TOUCH/ctiic.h"
 751              		.file 10 "/home/ktkuri/arm-gcc-tools/arm-none-eabi/include/stdio.h"
ARM GAS  /tmp/ccxgooGA.s 			page 19


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ft5206.c
     /tmp/ccxgooGA.s:18     .text.ft5206_wr_reg:0000000000000000 $t
     /tmp/ccxgooGA.s:26     .text.ft5206_wr_reg:0000000000000000 ft5206_wr_reg
     /tmp/ccxgooGA.s:115    .text.ft5206_rd_reg:0000000000000000 $t
     /tmp/ccxgooGA.s:122    .text.ft5206_rd_reg:0000000000000000 ft5206_rd_reg
     /tmp/ccxgooGA.s:208    .rodata.ft5206_init.str1.4:0000000000000000 $d
     /tmp/ccxgooGA.s:212    .text.ft5206_init:0000000000000000 $t
     /tmp/ccxgooGA.s:219    .text.ft5206_init:0000000000000000 ft5206_init
     /tmp/ccxgooGA.s:389    .text.ft5206_init:00000000000000e4 $d
     /tmp/ccxgooGA.s:397    .text.ft5206_scan:0000000000000000 $t
     /tmp/ccxgooGA.s:404    .text.ft5206_scan:0000000000000000 ft5206_scan
     /tmp/ccxgooGA.s:715    .text.ft5206_scan:0000000000000188 $d
     /tmp/ccxgooGA.s:735    .rodata.FT5206_TPX_TBL:0000000000000000 FT5206_TPX_TBL
     /tmp/ccxgooGA.s:728    .bss.t.0:0000000000000000 t.0
     /tmp/ccxgooGA.s:729    .bss.t.0:0000000000000000 $d
     /tmp/ccxgooGA.s:731    .rodata.FT5206_TPX_TBL:0000000000000000 $d

UNDEFINED SYMBOLS
ct_iic_start
ct_iic_send_byte
ct_iic_wait_ack
ct_iic_stop
ct_iic_read_byte
sys_gpio_set
ct_iic_init
sys_gpio_pin_set
delay_ms
printf
tp_dev
lcddev
