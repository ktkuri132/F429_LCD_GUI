ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"ft5206.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "TOUCH/ft5206.c"
  20              		.section	.text.ft5206_wr_reg,"ax",%progbits
  21              		.align	1
  22              		.global	ft5206_wr_reg
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	ft5206_wr_reg:
  28              	.LVL0:
  29              	.LFB126:
   1:TOUCH/ft5206.c **** /**
   2:TOUCH/ft5206.c ****  **************************************************************************************************
   3:TOUCH/ft5206.c ****  * @file        ft5206.c
   4:TOUCH/ft5206.c ****  * @author      正点原子团队(ALIENTEK)
   5:TOUCH/ft5206.c ****  * @version     V1.1
   6:TOUCH/ft5206.c ****  * @date        2022-12-27
   7:TOUCH/ft5206.c ****  * @brief       7寸电容触摸屏-FT5206/FT5426 驱动代码
   8:TOUCH/ft5206.c ****  * @license     Copyright (c) 2022-2032, 广州市星翼电子科技有限公司
   9:TOUCH/ft5206.c ****  **************************************************************************************************
  10:TOUCH/ft5206.c ****  * @attention
  11:TOUCH/ft5206.c ****  *
  12:TOUCH/ft5206.c ****  * 实验平台:正点原子 阿波罗 F429开发板
  13:TOUCH/ft5206.c ****  * 在线视频:www.yuanzige.com
  14:TOUCH/ft5206.c ****  * 技术论坛:www.openedv.com
  15:TOUCH/ft5206.c ****  * 公司网址:www.alientek.com
  16:TOUCH/ft5206.c ****  * 购买地址:openedv.taobao.com
  17:TOUCH/ft5206.c ****  *
  18:TOUCH/ft5206.c ****  * 修改说明
  19:TOUCH/ft5206.c ****  * V1.0 20221227
  20:TOUCH/ft5206.c ****  * 第一次发布
  21:TOUCH/ft5206.c ****  * V1.1 20230607
  22:TOUCH/ft5206.c ****  * 兼容7寸 CST340触摸屏
  23:TOUCH/ft5206.c ****  *
  24:TOUCH/ft5206.c ****  **************************************************************************************************
  25:TOUCH/ft5206.c ****  */
  26:TOUCH/ft5206.c **** 
  27:TOUCH/ft5206.c **** #include "string.h"
  28:TOUCH/ft5206.c **** #include "lcd.h"
  29:TOUCH/ft5206.c **** #include "touch.h"
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 2


  30:TOUCH/ft5206.c **** #include "ctiic.h"
  31:TOUCH/ft5206.c **** #include "ft5206.h"
  32:TOUCH/ft5206.c **** #include "usart.h"
  33:TOUCH/ft5206.c **** #include "delay.h"
  34:TOUCH/ft5206.c **** 
  35:TOUCH/ft5206.c **** 
  36:TOUCH/ft5206.c **** /**
  37:TOUCH/ft5206.c ****  * @brief       向FT5206写入一次数据
  38:TOUCH/ft5206.c ****  * @param       reg : 起始寄存器地址
  39:TOUCH/ft5206.c ****  * @param       buf : 数据缓缓存区
  40:TOUCH/ft5206.c ****  * @param       len : 写数据长度
  41:TOUCH/ft5206.c ****  * @retval      0, 成功; 1, 失败;
  42:TOUCH/ft5206.c ****  */
  43:TOUCH/ft5206.c **** uint8_t ft5206_wr_reg(uint16_t reg, uint8_t *buf, uint8_t len)
  44:TOUCH/ft5206.c **** {
  30              		.loc 1 44 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 44 1 is_stmt 0 view .LVU1
  35 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 24
  38              		.cfi_offset 3, -24
  39              		.cfi_offset 4, -20
  40              		.cfi_offset 5, -16
  41              		.cfi_offset 6, -12
  42              		.cfi_offset 7, -8
  43              		.cfi_offset 14, -4
  44 0002 0446     		mov	r4, r0
  45 0004 0F46     		mov	r7, r1
  46 0006 1546     		mov	r5, r2
  45:TOUCH/ft5206.c ****     uint8_t i;
  47              		.loc 1 45 5 is_stmt 1 view .LVU2
  46:TOUCH/ft5206.c ****     uint8_t ret = 0;
  48              		.loc 1 46 5 view .LVU3
  49              	.LVL1:
  47:TOUCH/ft5206.c ****     ct_iic_start();
  50              		.loc 1 47 5 view .LVU4
  51 0008 FFF7FEFF 		bl	ct_iic_start
  52              	.LVL2:
  48:TOUCH/ft5206.c ****     ct_iic_send_byte(FT5206_CMD_WR);    /* 发送写命令 */
  53              		.loc 1 48 5 view .LVU5
  54 000c 7020     		movs	r0, #112
  55 000e FFF7FEFF 		bl	ct_iic_send_byte
  56              	.LVL3:
  49:TOUCH/ft5206.c ****     ct_iic_wait_ack();
  57              		.loc 1 49 5 view .LVU6
  58 0012 FFF7FEFF 		bl	ct_iic_wait_ack
  59              	.LVL4:
  50:TOUCH/ft5206.c ****     ct_iic_send_byte(reg & 0XFF);       /* 发送低8位地址 */
  60              		.loc 1 50 5 view .LVU7
  61 0016 E0B2     		uxtb	r0, r4
  62 0018 FFF7FEFF 		bl	ct_iic_send_byte
  63              	.LVL5:
  51:TOUCH/ft5206.c ****     ct_iic_wait_ack();
  64              		.loc 1 51 5 view .LVU8
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 3


  65 001c FFF7FEFF 		bl	ct_iic_wait_ack
  66              	.LVL6:
  52:TOUCH/ft5206.c **** 
  53:TOUCH/ft5206.c ****     for (i = 0; i < len; i++)
  67              		.loc 1 53 5 view .LVU9
  46:TOUCH/ft5206.c ****     ct_iic_start();
  68              		.loc 1 46 13 is_stmt 0 view .LVU10
  69 0020 0026     		movs	r6, #0
  70              		.loc 1 53 12 view .LVU11
  71 0022 3446     		mov	r4, r6
  72              	.LVL7:
  73              		.loc 1 53 5 view .LVU12
  74 0024 01E0     		b	.L2
  75              	.LVL8:
  76              	.L6:
  77              		.loc 1 53 27 is_stmt 1 discriminator 2 view .LVU13
  78 0026 0134     		adds	r4, r4, #1
  79              	.LVL9:
  80              		.loc 1 53 27 is_stmt 0 discriminator 2 view .LVU14
  81 0028 E4B2     		uxtb	r4, r4
  82              	.LVL10:
  83              	.L2:
  84              		.loc 1 53 19 is_stmt 1 discriminator 1 view .LVU15
  85 002a AC42     		cmp	r4, r5
  86 002c 07D2     		bcs	.L3
  54:TOUCH/ft5206.c ****     {
  55:TOUCH/ft5206.c ****         ct_iic_send_byte(buf[i]);       /* 发数据 */
  87              		.loc 1 55 9 view .LVU16
  88 002e 385D     		ldrb	r0, [r7, r4]	@ zero_extendqisi2
  89 0030 FFF7FEFF 		bl	ct_iic_send_byte
  90              	.LVL11:
  56:TOUCH/ft5206.c ****         ret = ct_iic_wait_ack();
  91              		.loc 1 56 9 view .LVU17
  92              		.loc 1 56 15 is_stmt 0 view .LVU18
  93 0034 FFF7FEFF 		bl	ct_iic_wait_ack
  94              	.LVL12:
  57:TOUCH/ft5206.c **** 
  58:TOUCH/ft5206.c ****         if (ret)break;
  95              		.loc 1 58 9 is_stmt 1 view .LVU19
  96              		.loc 1 58 12 is_stmt 0 view .LVU20
  97 0038 0646     		mov	r6, r0
  98 003a 0028     		cmp	r0, #0
  99 003c F3D0     		beq	.L6
 100              	.LVL13:
 101              	.L3:
  59:TOUCH/ft5206.c ****     }
  60:TOUCH/ft5206.c **** 
  61:TOUCH/ft5206.c ****     ct_iic_stop();  /* 产生一个停止条件 */
 102              		.loc 1 61 5 is_stmt 1 view .LVU21
 103 003e FFF7FEFF 		bl	ct_iic_stop
 104              	.LVL14:
  62:TOUCH/ft5206.c ****     return ret;
 105              		.loc 1 62 5 view .LVU22
  63:TOUCH/ft5206.c **** }
 106              		.loc 1 63 1 is_stmt 0 view .LVU23
 107 0042 3046     		mov	r0, r6
 108 0044 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 4


 109              		.loc 1 63 1 view .LVU24
 110              		.cfi_endproc
 111              	.LFE126:
 113              		.section	.text.ft5206_rd_reg,"ax",%progbits
 114              		.align	1
 115              		.global	ft5206_rd_reg
 116              		.syntax unified
 117              		.thumb
 118              		.thumb_func
 120              	ft5206_rd_reg:
 121              	.LVL15:
 122              	.LFB127:
  64:TOUCH/ft5206.c **** 
  65:TOUCH/ft5206.c **** /**
  66:TOUCH/ft5206.c ****  * @brief       从FT5206读出一次数据
  67:TOUCH/ft5206.c ****  * @param       reg : 起始寄存器地址
  68:TOUCH/ft5206.c ****  * @param       buf : 数据缓缓存区
  69:TOUCH/ft5206.c ****  * @param       len : 读数据长度
  70:TOUCH/ft5206.c ****  * @retval      无
  71:TOUCH/ft5206.c ****  */
  72:TOUCH/ft5206.c **** void ft5206_rd_reg(uint16_t reg, uint8_t *buf, uint8_t len)
  73:TOUCH/ft5206.c **** {
 123              		.loc 1 73 1 is_stmt 1 view -0
 124              		.cfi_startproc
 125              		@ args = 0, pretend = 0, frame = 0
 126              		@ frame_needed = 0, uses_anonymous_args = 0
 127              		.loc 1 73 1 is_stmt 0 view .LVU26
 128 0000 70B5     		push	{r4, r5, r6, lr}
 129              	.LCFI1:
 130              		.cfi_def_cfa_offset 16
 131              		.cfi_offset 4, -16
 132              		.cfi_offset 5, -12
 133              		.cfi_offset 6, -8
 134              		.cfi_offset 14, -4
 135 0002 0446     		mov	r4, r0
 136 0004 0E46     		mov	r6, r1
 137 0006 1546     		mov	r5, r2
  74:TOUCH/ft5206.c ****     uint8_t i;
 138              		.loc 1 74 5 is_stmt 1 view .LVU27
  75:TOUCH/ft5206.c ****     ct_iic_start();
 139              		.loc 1 75 5 view .LVU28
 140 0008 FFF7FEFF 		bl	ct_iic_start
 141              	.LVL16:
  76:TOUCH/ft5206.c ****     ct_iic_send_byte(FT5206_CMD_WR);    /* 发送写命令 */
 142              		.loc 1 76 5 view .LVU29
 143 000c 7020     		movs	r0, #112
 144 000e FFF7FEFF 		bl	ct_iic_send_byte
 145              	.LVL17:
  77:TOUCH/ft5206.c ****     ct_iic_wait_ack();
 146              		.loc 1 77 5 view .LVU30
 147 0012 FFF7FEFF 		bl	ct_iic_wait_ack
 148              	.LVL18:
  78:TOUCH/ft5206.c ****     ct_iic_send_byte(reg & 0XFF);       /* 发送低8位地址 */
 149              		.loc 1 78 5 view .LVU31
 150 0016 E0B2     		uxtb	r0, r4
 151 0018 FFF7FEFF 		bl	ct_iic_send_byte
 152              	.LVL19:
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 5


  79:TOUCH/ft5206.c ****     ct_iic_wait_ack();
 153              		.loc 1 79 5 view .LVU32
 154 001c FFF7FEFF 		bl	ct_iic_wait_ack
 155              	.LVL20:
  80:TOUCH/ft5206.c ****     ct_iic_start();
 156              		.loc 1 80 5 view .LVU33
 157 0020 FFF7FEFF 		bl	ct_iic_start
 158              	.LVL21:
  81:TOUCH/ft5206.c ****     ct_iic_send_byte(FT5206_CMD_RD);    /* 发送读命令 */
 159              		.loc 1 81 5 view .LVU34
 160 0024 7120     		movs	r0, #113
 161 0026 FFF7FEFF 		bl	ct_iic_send_byte
 162              	.LVL22:
  82:TOUCH/ft5206.c ****     ct_iic_wait_ack();
 163              		.loc 1 82 5 view .LVU35
 164 002a FFF7FEFF 		bl	ct_iic_wait_ack
 165              	.LVL23:
  83:TOUCH/ft5206.c **** 
  84:TOUCH/ft5206.c ****     for (i = 0; i < len; i++)
 166              		.loc 1 84 5 view .LVU36
 167              		.loc 1 84 12 is_stmt 0 view .LVU37
 168 002e 0024     		movs	r4, #0
 169              	.LVL24:
 170              		.loc 1 84 5 view .LVU38
 171 0030 08E0     		b	.L8
 172              	.LVL25:
 173              	.L9:
  85:TOUCH/ft5206.c ****     {
  86:TOUCH/ft5206.c ****         buf[i] = ct_iic_read_byte(i == (len - 1) ? 0 : 1);  /* 发数据 */
 174              		.loc 1 86 9 is_stmt 1 view .LVU39
 175              		.loc 1 86 45 is_stmt 0 view .LVU40
 176 0032 681E     		subs	r0, r5, #1
 177              		.loc 1 86 18 view .LVU41
 178 0034 201A     		subs	r0, r4, r0
 179 0036 18BF     		it	ne
 180 0038 0120     		movne	r0, #1
 181 003a FFF7FEFF 		bl	ct_iic_read_byte
 182              	.LVL26:
 183              		.loc 1 86 16 discriminator 1 view .LVU42
 184 003e 3055     		strb	r0, [r6, r4]
  84:TOUCH/ft5206.c ****     {
 185              		.loc 1 84 27 is_stmt 1 discriminator 3 view .LVU43
 186 0040 0134     		adds	r4, r4, #1
 187              	.LVL27:
  84:TOUCH/ft5206.c ****     {
 188              		.loc 1 84 27 is_stmt 0 discriminator 3 view .LVU44
 189 0042 E4B2     		uxtb	r4, r4
 190              	.LVL28:
 191              	.L8:
  84:TOUCH/ft5206.c ****     {
 192              		.loc 1 84 19 is_stmt 1 discriminator 1 view .LVU45
 193 0044 AC42     		cmp	r4, r5
 194 0046 F4D3     		bcc	.L9
  87:TOUCH/ft5206.c ****     }
  88:TOUCH/ft5206.c **** 
  89:TOUCH/ft5206.c ****     ct_iic_stop();  /* 产生一个停止条件 */
 195              		.loc 1 89 5 view .LVU46
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 6


 196 0048 FFF7FEFF 		bl	ct_iic_stop
 197              	.LVL29:
  90:TOUCH/ft5206.c **** }
 198              		.loc 1 90 1 is_stmt 0 view .LVU47
 199 004c 70BD     		pop	{r4, r5, r6, pc}
 200              		.loc 1 90 1 view .LVU48
 201              		.cfi_endproc
 202              	.LFE127:
 204              		.section	.rodata.ft5206_init.str1.4,"aMS",%progbits,1
 205              		.align	2
 206              	.LC0:
 207 0000 43545020 		.ascii	"CTP ID:%x\015\012\000"
 207      49443A25 
 207      780D0A00 
 208              		.section	.text.ft5206_init,"ax",%progbits
 209              		.align	1
 210              		.global	ft5206_init
 211              		.syntax unified
 212              		.thumb
 213              		.thumb_func
 215              	ft5206_init:
 216              	.LFB128:
  91:TOUCH/ft5206.c **** 
  92:TOUCH/ft5206.c **** /**
  93:TOUCH/ft5206.c ****  * @brief       初始化FT5206触摸屏
  94:TOUCH/ft5206.c ****  * @param       无
  95:TOUCH/ft5206.c ****  * @retval      0, 初始化成功; 1, 初始化失败;
  96:TOUCH/ft5206.c ****  */
  97:TOUCH/ft5206.c **** uint8_t ft5206_init(void)
  98:TOUCH/ft5206.c **** {
 217              		.loc 1 98 1 is_stmt 1 view -0
 218              		.cfi_startproc
 219              		@ args = 0, pretend = 0, frame = 8
 220              		@ frame_needed = 0, uses_anonymous_args = 0
 221 0000 30B5     		push	{r4, r5, lr}
 222              	.LCFI2:
 223              		.cfi_def_cfa_offset 12
 224              		.cfi_offset 4, -12
 225              		.cfi_offset 5, -8
 226              		.cfi_offset 14, -4
 227 0002 85B0     		sub	sp, sp, #20
 228              	.LCFI3:
 229              		.cfi_def_cfa_offset 32
  99:TOUCH/ft5206.c ****     uint8_t temp[2];
 230              		.loc 1 99 5 view .LVU50
 100:TOUCH/ft5206.c **** 
 101:TOUCH/ft5206.c ****     FT5206_RST_GPIO_CLK_ENABLE();   /* RST引脚时钟使能 */
 231              		.loc 1 101 5 view .LVU51
 232              		.loc 1 101 5 view .LVU52
 233 0004 374B     		ldr	r3, .L19
 234 0006 1A6B     		ldr	r2, [r3, #48]
 235 0008 42F48072 		orr	r2, r2, #256
 236 000c 1A63     		str	r2, [r3, #48]
 237              		.loc 1 101 5 view .LVU53
 102:TOUCH/ft5206.c ****     FT5206_INT_GPIO_CLK_ENABLE();   /* INT引脚时钟使能 */
 238              		.loc 1 102 5 view .LVU54
 239              		.loc 1 102 5 view .LVU55
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 7


 240 000e 1A6B     		ldr	r2, [r3, #48]
 241 0010 42F08002 		orr	r2, r2, #128
 242 0014 1A63     		str	r2, [r3, #48]
 243              		.loc 1 102 5 view .LVU56
 103:TOUCH/ft5206.c **** 
 104:TOUCH/ft5206.c ****     /* RST引脚模式设置, 推挽输出, 上拉 */
 105:TOUCH/ft5206.c ****     sys_gpio_set(FT5206_RST_GPIO_PORT, FT5206_RST_GPIO_PIN,
 244              		.loc 1 105 5 view .LVU57
 245 0016 344D     		ldr	r5, .L19+4
 246 0018 0124     		movs	r4, #1
 247 001a 0194     		str	r4, [sp, #4]
 248 001c 0094     		str	r4, [sp]
 249 001e 0023     		movs	r3, #0
 250 0020 2246     		mov	r2, r4
 251 0022 4FF48071 		mov	r1, #256
 252 0026 2846     		mov	r0, r5
 253 0028 FFF7FEFF 		bl	sys_gpio_set
 254              	.LVL30:
 106:TOUCH/ft5206.c ****                  SYS_GPIO_MODE_OUT, SYS_GPIO_OTYPE_PP, SYS_GPIO_SPEED_MID, SYS_GPIO_PUPD_PU);
 107:TOUCH/ft5206.c **** 
 108:TOUCH/ft5206.c ****     /* INT引脚模式设置, 输入模式, 上拉 */
 109:TOUCH/ft5206.c ****     sys_gpio_set(FT5206_INT_GPIO_PORT, FT5206_INT_GPIO_PIN,
 255              		.loc 1 109 5 view .LVU58
 256 002c 0194     		str	r4, [sp, #4]
 257 002e 0094     		str	r4, [sp]
 258 0030 0023     		movs	r3, #0
 259 0032 1A46     		mov	r2, r3
 260 0034 8021     		movs	r1, #128
 261 0036 2D48     		ldr	r0, .L19+8
 262 0038 FFF7FEFF 		bl	sys_gpio_set
 263              	.LVL31:
 110:TOUCH/ft5206.c ****                  SYS_GPIO_MODE_IN, SYS_GPIO_OTYPE_PP, SYS_GPIO_SPEED_MID, SYS_GPIO_PUPD_PU);
 111:TOUCH/ft5206.c **** 
 112:TOUCH/ft5206.c ****     
 113:TOUCH/ft5206.c ****     ct_iic_init();      /* 初始化电容屏的I2C总线 */
 264              		.loc 1 113 5 view .LVU59
 265 003c FFF7FEFF 		bl	ct_iic_init
 266              	.LVL32:
 114:TOUCH/ft5206.c ****     FT5206_RST(0);      /* 复位 */
 267              		.loc 1 114 5 view .LVU60
 268 0040 0022     		movs	r2, #0
 269 0042 4FF48071 		mov	r1, #256
 270 0046 2846     		mov	r0, r5
 271 0048 FFF7FEFF 		bl	sys_gpio_pin_set
 272              	.LVL33:
 115:TOUCH/ft5206.c ****     delay_ms(20);
 273              		.loc 1 115 5 view .LVU61
 274 004c 1420     		movs	r0, #20
 275 004e FFF7FEFF 		bl	delay_ms
 276              	.LVL34:
 116:TOUCH/ft5206.c ****     FT5206_RST(1);      /* 释放复位 */
 277              		.loc 1 116 5 view .LVU62
 278 0052 2246     		mov	r2, r4
 279 0054 4FF48071 		mov	r1, #256
 280 0058 2846     		mov	r0, r5
 281 005a FFF7FEFF 		bl	sys_gpio_pin_set
 282              	.LVL35:
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 8


 117:TOUCH/ft5206.c ****     delay_ms(50);
 283              		.loc 1 117 5 view .LVU63
 284 005e 3220     		movs	r0, #50
 285 0060 FFF7FEFF 		bl	delay_ms
 286              	.LVL36:
 118:TOUCH/ft5206.c ****     temp[0] = 0;
 287              		.loc 1 118 5 view .LVU64
 288              		.loc 1 118 13 is_stmt 0 view .LVU65
 289 0064 0020     		movs	r0, #0
 290 0066 8DF80C00 		strb	r0, [sp, #12]
 119:TOUCH/ft5206.c ****     ft5206_wr_reg(FT5206_DEVIDE_MODE, temp, 1); /* 进入正常操作模式 */
 291              		.loc 1 119 5 is_stmt 1 view .LVU66
 292 006a 2246     		mov	r2, r4
 293 006c 03A9     		add	r1, sp, #12
 294 006e FFF7FEFF 		bl	ft5206_wr_reg
 295              	.LVL37:
 120:TOUCH/ft5206.c ****     ft5206_wr_reg(FT5206_ID_G_MODE, temp, 1);   /* 查询模式 */
 296              		.loc 1 120 5 view .LVU67
 297 0072 2246     		mov	r2, r4
 298 0074 03A9     		add	r1, sp, #12
 299 0076 A420     		movs	r0, #164
 300 0078 FFF7FEFF 		bl	ft5206_wr_reg
 301              	.LVL38:
 121:TOUCH/ft5206.c ****     temp[0] = 22;                               /* 触摸有效值，22，越小越灵敏 */
 302              		.loc 1 121 5 view .LVU68
 303              		.loc 1 121 13 is_stmt 0 view .LVU69
 304 007c 1623     		movs	r3, #22
 305 007e 8DF80C30 		strb	r3, [sp, #12]
 122:TOUCH/ft5206.c ****     ft5206_wr_reg(FT5206_ID_G_THGROUP, temp, 1);/* 设置触摸有效值 */
 306              		.loc 1 122 5 is_stmt 1 view .LVU70
 307 0082 2246     		mov	r2, r4
 308 0084 03A9     		add	r1, sp, #12
 309 0086 8020     		movs	r0, #128
 310 0088 FFF7FEFF 		bl	ft5206_wr_reg
 311              	.LVL39:
 123:TOUCH/ft5206.c ****     temp[0] = 12;                               /* 激活周期，不能小于12，最大14 */
 312              		.loc 1 123 5 view .LVU71
 313              		.loc 1 123 13 is_stmt 0 view .LVU72
 314 008c 0C23     		movs	r3, #12
 315 008e 8DF80C30 		strb	r3, [sp, #12]
 124:TOUCH/ft5206.c ****     ft5206_wr_reg(FT5206_ID_G_PERIODACTIVE, temp, 1);
 316              		.loc 1 124 5 is_stmt 1 view .LVU73
 317 0092 2246     		mov	r2, r4
 318 0094 0DEB0301 		add	r1, sp, r3
 319 0098 8820     		movs	r0, #136
 320 009a FFF7FEFF 		bl	ft5206_wr_reg
 321              	.LVL40:
 125:TOUCH/ft5206.c ****     
 126:TOUCH/ft5206.c ****     /* 读取版本号，参考值：0x3003 */
 127:TOUCH/ft5206.c ****     ft5206_rd_reg(FT5206_ID_G_LIB_VERSION, &temp[0], 2);
 322              		.loc 1 127 5 view .LVU74
 323 009e 0222     		movs	r2, #2
 324 00a0 03A9     		add	r1, sp, #12
 325 00a2 A120     		movs	r0, #161
 326 00a4 FFF7FEFF 		bl	ft5206_rd_reg
 327              	.LVL41:
 128:TOUCH/ft5206.c **** 
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 9


 129:TOUCH/ft5206.c ****     if ((temp[0] == 0X30 && temp[1] == 0X03) || temp[1] == 0X01 || temp[1] == 0X02 || (temp[0] == 0
 328              		.loc 1 129 5 view .LVU75
 329              		.loc 1 129 14 is_stmt 0 view .LVU76
 330 00a8 9DF80C30 		ldrb	r3, [sp, #12]	@ zero_extendqisi2
 331              		.loc 1 129 8 view .LVU77
 332 00ac 302B     		cmp	r3, #48
 333 00ae 09D0     		beq	.L18
 334              	.L12:
 335              		.loc 1 129 53 discriminator 3 view .LVU78
 336 00b0 9DF80D20 		ldrb	r2, [sp, #13]	@ zero_extendqisi2
 337              		.loc 1 129 46 discriminator 3 view .LVU79
 338 00b4 012A     		cmp	r2, #1
 339 00b6 09D0     		beq	.L13
 340              		.loc 1 129 65 discriminator 4 view .LVU80
 341 00b8 022A     		cmp	r2, #2
 342 00ba 07D0     		beq	.L13
 343              		.loc 1 129 84 discriminator 5 view .LVU81
 344 00bc 83B9     		cbnz	r3, .L15
 345              		.loc 1 129 103 discriminator 6 view .LVU82
 346 00be 2AB1     		cbz	r2, .L13
 130:TOUCH/ft5206.c ****     {
 131:TOUCH/ft5206.c ****         printf("CTP ID:%x\r\n", ((uint16_t)temp[0] << 8) + temp[1]);
 132:TOUCH/ft5206.c ****         return 0;
 133:TOUCH/ft5206.c ****     }
 134:TOUCH/ft5206.c **** 
 135:TOUCH/ft5206.c ****     return 1;
 347              		.loc 1 135 12 view .LVU83
 348 00c0 0120     		movs	r0, #1
 349 00c2 0BE0     		b	.L14
 350              	.L18:
 129:TOUCH/ft5206.c ****     {
 351              		.loc 1 129 33 discriminator 1 view .LVU84
 352 00c4 9DF80D20 		ldrb	r2, [sp, #13]	@ zero_extendqisi2
 129:TOUCH/ft5206.c ****     {
 353              		.loc 1 129 26 discriminator 1 view .LVU85
 354 00c8 032A     		cmp	r2, #3
 355 00ca F1D1     		bne	.L12
 356              	.L13:
 131:TOUCH/ft5206.c ****         return 0;
 357              		.loc 1 131 9 is_stmt 1 view .LVU86
 131:TOUCH/ft5206.c ****         return 0;
 358              		.loc 1 131 64 is_stmt 0 view .LVU87
 359 00cc 9DF80D10 		ldrb	r1, [sp, #13]	@ zero_extendqisi2
 131:TOUCH/ft5206.c ****         return 0;
 360              		.loc 1 131 9 view .LVU88
 361 00d0 01EB0321 		add	r1, r1, r3, lsl #8
 362 00d4 0648     		ldr	r0, .L19+12
 363 00d6 FFF7FEFF 		bl	printf
 364              	.LVL42:
 132:TOUCH/ft5206.c ****     }
 365              		.loc 1 132 9 is_stmt 1 view .LVU89
 132:TOUCH/ft5206.c ****     }
 366              		.loc 1 132 16 is_stmt 0 view .LVU90
 367 00da 0020     		movs	r0, #0
 368              	.L14:
 136:TOUCH/ft5206.c **** }
 369              		.loc 1 136 1 view .LVU91
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 10


 370 00dc 05B0     		add	sp, sp, #20
 371              	.LCFI4:
 372              		.cfi_remember_state
 373              		.cfi_def_cfa_offset 12
 374              		@ sp needed
 375 00de 30BD     		pop	{r4, r5, pc}
 376              	.L15:
 377              	.LCFI5:
 378              		.cfi_restore_state
 135:TOUCH/ft5206.c **** }
 379              		.loc 1 135 12 view .LVU92
 380 00e0 0120     		movs	r0, #1
 381 00e2 FBE7     		b	.L14
 382              	.L20:
 383              		.align	2
 384              	.L19:
 385 00e4 00380240 		.word	1073887232
 386 00e8 00200240 		.word	1073881088
 387 00ec 001C0240 		.word	1073880064
 388 00f0 00000000 		.word	.LC0
 389              		.cfi_endproc
 390              	.LFE128:
 392              		.section	.text.ft5206_scan,"ax",%progbits
 393              		.align	1
 394              		.global	ft5206_scan
 395              		.syntax unified
 396              		.thumb
 397              		.thumb_func
 399              	ft5206_scan:
 400              	.LVL43:
 401              	.LFB129:
 137:TOUCH/ft5206.c **** 
 138:TOUCH/ft5206.c **** /* FT5206 5个触摸点 对应的寄存器表 */
 139:TOUCH/ft5206.c **** const uint16_t FT5206_TPX_TBL[5] = {FT5206_TP1_REG, FT5206_TP2_REG, FT5206_TP3_REG, FT5206_TP4_REG,
 140:TOUCH/ft5206.c **** 
 141:TOUCH/ft5206.c **** /**
 142:TOUCH/ft5206.c ****  * @brief       扫描触摸屏(采用查询方式)
 143:TOUCH/ft5206.c ****  * @param       mode : 电容屏未用到次参数, 为了兼容电阻屏
 144:TOUCH/ft5206.c ****  * @retval      当前触屏状态
 145:TOUCH/ft5206.c ****  *   @arg       0, 触屏无触摸; 
 146:TOUCH/ft5206.c ****  *   @arg       1, 触屏有触摸;
 147:TOUCH/ft5206.c ****  */
 148:TOUCH/ft5206.c **** uint8_t ft5206_scan(uint8_t mode)
 149:TOUCH/ft5206.c **** {
 402              		.loc 1 149 1 is_stmt 1 view -0
 403              		.cfi_startproc
 404              		@ args = 0, pretend = 0, frame = 8
 405              		@ frame_needed = 0, uses_anonymous_args = 0
 406              		.loc 1 149 1 is_stmt 0 view .LVU94
 407 0000 30B5     		push	{r4, r5, lr}
 408              	.LCFI6:
 409              		.cfi_def_cfa_offset 12
 410              		.cfi_offset 4, -12
 411              		.cfi_offset 5, -8
 412              		.cfi_offset 14, -4
 413 0002 83B0     		sub	sp, sp, #12
 414              	.LCFI7:
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 11


 415              		.cfi_def_cfa_offset 24
 150:TOUCH/ft5206.c ****     uint8_t sta = 0;
 416              		.loc 1 150 5 is_stmt 1 view .LVU95
 417              		.loc 1 150 13 is_stmt 0 view .LVU96
 418 0004 0023     		movs	r3, #0
 419 0006 8DF80730 		strb	r3, [sp, #7]
 151:TOUCH/ft5206.c ****     uint8_t buf[4];
 420              		.loc 1 151 5 is_stmt 1 view .LVU97
 152:TOUCH/ft5206.c ****     uint8_t i = 0;
 421              		.loc 1 152 5 view .LVU98
 422              	.LVL44:
 153:TOUCH/ft5206.c ****     uint8_t res = 0;
 423              		.loc 1 153 5 view .LVU99
 154:TOUCH/ft5206.c ****     uint16_t temp;
 424              		.loc 1 154 5 view .LVU100
 155:TOUCH/ft5206.c ****     static uint8_t t = 0;   /* 控制查询间隔,从而降低CPU占用率 */
 425              		.loc 1 155 5 view .LVU101
 156:TOUCH/ft5206.c ****     
 157:TOUCH/ft5206.c ****     t++;
 426              		.loc 1 157 5 view .LVU102
 427              		.loc 1 157 6 is_stmt 0 view .LVU103
 428 000a 5F4B     		ldr	r3, .L39
 429 000c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 430 000e 0132     		adds	r2, r2, #1
 431 0010 D2B2     		uxtb	r2, r2
 432 0012 1A70     		strb	r2, [r3]
 158:TOUCH/ft5206.c ****     
 159:TOUCH/ft5206.c ****     if ((t % 10) == 0 || t < 10)   /* 空闲时,每进入10次CTP_Scan函数才检测1次,从而节省CPU使用率 */
 433              		.loc 1 159 5 is_stmt 1 view .LVU104
 434              		.loc 1 159 18 is_stmt 0 view .LVU105
 435 0014 5D4B     		ldr	r3, .L39+4
 436 0016 A3FB0213 		umull	r1, r3, r3, r2
 437 001a DB08     		lsrs	r3, r3, #3
 438 001c 03EB8303 		add	r3, r3, r3, lsl #2
 439 0020 5900     		lsls	r1, r3, #1
 440 0022 511A     		subs	r1, r2, r1
 441              		.loc 1 159 8 view .LVU106
 442 0024 11F0FF0F 		tst	r1, #255
 443 0028 02D0     		beq	.L22
 444              		.loc 1 159 23 discriminator 1 view .LVU107
 445 002a 092A     		cmp	r2, #9
 446 002c 00F28980 		bhi	.L33
 447              	.L22:
 160:TOUCH/ft5206.c ****     {
 161:TOUCH/ft5206.c ****         ft5206_rd_reg(FT5206_REG_NUM_FINGER, &sta, 1);  /* 读取触摸点的状态 */
 448              		.loc 1 161 9 is_stmt 1 view .LVU108
 449 0030 0122     		movs	r2, #1
 450 0032 0DF10701 		add	r1, sp, #7
 451 0036 0220     		movs	r0, #2
 452              	.LVL45:
 453              		.loc 1 161 9 is_stmt 0 view .LVU109
 454 0038 FFF7FEFF 		bl	ft5206_rd_reg
 455              	.LVL46:
 162:TOUCH/ft5206.c **** 
 163:TOUCH/ft5206.c ****         if ((sta & 0XF) && ((sta & 0XF) < 6))
 456              		.loc 1 163 9 is_stmt 1 view .LVU110
 457              		.loc 1 163 18 is_stmt 0 view .LVU111
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 12


 458 003c 9DF80700 		ldrb	r0, [sp, #7]	@ zero_extendqisi2
 459              		.loc 1 163 12 view .LVU112
 460 0040 10F00F00 		ands	r0, r0, #15
 461 0044 7ED0     		beq	.L23
 462              		.loc 1 163 25 discriminator 1 view .LVU113
 463 0046 0528     		cmp	r0, #5
 464 0048 01D9     		bls	.L36
 153:TOUCH/ft5206.c ****     uint16_t temp;
 465              		.loc 1 153 13 view .LVU114
 466 004a 0020     		movs	r0, #0
 467 004c 7AE0     		b	.L23
 468              	.L36:
 164:TOUCH/ft5206.c ****         {
 165:TOUCH/ft5206.c ****             temp = 0XFFFF << (sta & 0XF);           /* 将点的个数转换为1的位数,匹配tp_dev.sta定义 *
 469              		.loc 1 165 13 is_stmt 1 view .LVU115
 470              		.loc 1 165 27 is_stmt 0 view .LVU116
 471 004e 4FF6FF73 		movw	r3, #65535
 472 0052 8340     		lsls	r3, r3, r0
 473              	.LVL47:
 166:TOUCH/ft5206.c ****             tp_dev.sta = (~temp) | TP_PRES_DOWN | TP_CATH_PRES;
 474              		.loc 1 166 13 is_stmt 1 view .LVU117
 475              		.loc 1 166 49 is_stmt 0 view .LVU118
 476 0054 DB43     		mvns	r3, r3
 477              	.LVL48:
 478              		.loc 1 166 49 view .LVU119
 479 0056 6FEA8343 		mvn	r3, r3, lsl #18
 480              	.LVL49:
 481              		.loc 1 166 49 view .LVU120
 482 005a 6FEA9343 		mvn	r3, r3, lsr #18
 483              		.loc 1 166 24 view .LVU121
 484 005e 4C4A     		ldr	r2, .L39+8
 485 0060 9386     		strh	r3, [r2, #52]	@ movhi
 167:TOUCH/ft5206.c **** 
 168:TOUCH/ft5206.c ****             delay_ms(4);                            /* 必要的延时，否则老是认为有按键按下 */
 486              		.loc 1 168 13 is_stmt 1 view .LVU122
 487 0062 0420     		movs	r0, #4
 488              	.LVL50:
 489              		.loc 1 168 13 is_stmt 0 view .LVU123
 490 0064 FFF7FEFF 		bl	delay_ms
 491              	.LVL51:
 169:TOUCH/ft5206.c ****             
 170:TOUCH/ft5206.c ****             for (i = 0; i < 5; i++)
 492              		.loc 1 170 13 is_stmt 1 view .LVU124
 493              		.loc 1 170 20 is_stmt 0 view .LVU125
 494 0068 0024     		movs	r4, #0
 495              		.loc 1 170 13 view .LVU126
 496 006a 2DE0     		b	.L24
 497              	.LVL52:
 498              	.L26:
 171:TOUCH/ft5206.c ****             {
 172:TOUCH/ft5206.c ****                 if (tp_dev.sta & (1 << i))          /* 触摸有效? */
 173:TOUCH/ft5206.c ****                 {
 174:TOUCH/ft5206.c ****                     ft5206_rd_reg(FT5206_TPX_TBL[i], buf, 4);   /* 读取XY坐标值 */
 175:TOUCH/ft5206.c **** 
 176:TOUCH/ft5206.c ****                     if (tp_dev.touchtype & 0X01)    /* 横屏 */
 177:TOUCH/ft5206.c ****                     {
 178:TOUCH/ft5206.c ****                         tp_dev.y[i] = ((uint16_t)(buf[0] & 0X0F) << 8) + buf[1];
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 13


 179:TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 180:TOUCH/ft5206.c ****                     }
 181:TOUCH/ft5206.c ****                     else
 182:TOUCH/ft5206.c ****                     {
 183:TOUCH/ft5206.c ****                         tp_dev.x[i] = lcddev.width - (((uint16_t)(buf[0] & 0X0F) << 8) + buf[1]);
 499              		.loc 1 183 25 is_stmt 1 view .LVU127
 500              		.loc 1 183 45 is_stmt 0 view .LVU128
 501 006c 494B     		ldr	r3, .L39+12
 502 006e 1A88     		ldrh	r2, [r3]
 503              		.loc 1 183 70 view .LVU129
 504 0070 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 505              		.loc 1 183 82 view .LVU130
 506 0074 1B02     		lsls	r3, r3, #8
 507 0076 03F47063 		and	r3, r3, #3840
 508              		.loc 1 183 93 view .LVU131
 509 007a 9DF80110 		ldrb	r1, [sp, #1]	@ zero_extendqisi2
 510              		.loc 1 183 88 view .LVU132
 511 007e 0B44     		add	r3, r3, r1
 512              		.loc 1 183 52 view .LVU133
 513 0080 D21A     		subs	r2, r2, r3
 514              		.loc 1 183 37 view .LVU134
 515 0082 4349     		ldr	r1, .L39+8
 516 0084 231D     		adds	r3, r4, #4
 517 0086 01EB4303 		add	r3, r1, r3, lsl #1
 518 008a 9A80     		strh	r2, [r3, #4]	@ movhi
 184:TOUCH/ft5206.c ****                         tp_dev.y[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 519              		.loc 1 184 25 is_stmt 1 view .LVU135
 520              		.loc 1 184 54 is_stmt 0 view .LVU136
 521 008c 9DF80230 		ldrb	r3, [sp, #2]	@ zero_extendqisi2
 522              		.loc 1 184 66 view .LVU137
 523 0090 1B02     		lsls	r3, r3, #8
 524 0092 03F47063 		and	r3, r3, #3840
 525              		.loc 1 184 77 view .LVU138
 526 0096 9DF80320 		ldrb	r2, [sp, #3]	@ zero_extendqisi2
 527              		.loc 1 184 72 view .LVU139
 528 009a 1344     		add	r3, r3, r2
 529              		.loc 1 184 37 view .LVU140
 530 009c 04F11002 		add	r2, r4, #16
 531 00a0 21F81230 		strh	r3, [r1, r2, lsl #1]	@ movhi
 532              	.L27:
 185:TOUCH/ft5206.c ****                     }
 186:TOUCH/ft5206.c **** 
 187:TOUCH/ft5206.c ****                     if ((buf[0] & 0XF0) != 0X80)tp_dev.x[i] = tp_dev.y[i] = 0; /* 必须是contact事件
 533              		.loc 1 187 21 is_stmt 1 view .LVU141
 534              		.loc 1 187 29 is_stmt 0 view .LVU142
 535 00a4 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 536              		.loc 1 187 24 view .LVU143
 537 00a8 03F0F003 		and	r3, r3, #240
 538 00ac 802B     		cmp	r3, #128
 539 00ae 09D0     		beq	.L25
 540              		.loc 1 187 49 is_stmt 1 discriminator 1 view .LVU144
 541              		.loc 1 187 75 is_stmt 0 discriminator 1 view .LVU145
 542 00b0 374B     		ldr	r3, .L39+8
 543 00b2 05F11001 		add	r1, r5, #16
 544 00b6 0022     		movs	r2, #0
 545 00b8 23F81120 		strh	r2, [r3, r1, lsl #1]	@ movhi
 546              		.loc 1 187 61 discriminator 1 view .LVU146
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 14


 547 00bc 0435     		adds	r5, r5, #4
 548 00be 03EB4503 		add	r3, r3, r5, lsl #1
 549 00c2 9A80     		strh	r2, [r3, #4]	@ movhi
 550              	.L25:
 170:TOUCH/ft5206.c ****             {
 551              		.loc 1 170 33 is_stmt 1 discriminator 2 view .LVU147
 552 00c4 0134     		adds	r4, r4, #1
 553              	.LVL53:
 170:TOUCH/ft5206.c ****             {
 554              		.loc 1 170 33 is_stmt 0 discriminator 2 view .LVU148
 555 00c6 E4B2     		uxtb	r4, r4
 556              	.LVL54:
 557              	.L24:
 170:TOUCH/ft5206.c ****             {
 558              		.loc 1 170 27 is_stmt 1 discriminator 1 view .LVU149
 559 00c8 042C     		cmp	r4, #4
 560 00ca 2DD8     		bhi	.L37
 172:TOUCH/ft5206.c ****                 {
 561              		.loc 1 172 17 view .LVU150
 172:TOUCH/ft5206.c ****                 {
 562              		.loc 1 172 27 is_stmt 0 view .LVU151
 563 00cc 304B     		ldr	r3, .L39+8
 564 00ce 9B8E     		ldrh	r3, [r3, #52]
 172:TOUCH/ft5206.c ****                 {
 565              		.loc 1 172 21 view .LVU152
 566 00d0 2546     		mov	r5, r4
 567 00d2 2341     		asrs	r3, r3, r4
 172:TOUCH/ft5206.c ****                 {
 568              		.loc 1 172 20 view .LVU153
 569 00d4 13F0010F 		tst	r3, #1
 570 00d8 F4D0     		beq	.L25
 174:TOUCH/ft5206.c **** 
 571              		.loc 1 174 21 is_stmt 1 view .LVU154
 572 00da 0422     		movs	r2, #4
 573 00dc 6946     		mov	r1, sp
 574 00de 2E4B     		ldr	r3, .L39+16
 575 00e0 33F81400 		ldrh	r0, [r3, r4, lsl #1]
 576 00e4 FFF7FEFF 		bl	ft5206_rd_reg
 577              	.LVL55:
 176:TOUCH/ft5206.c ****                     {
 578              		.loc 1 176 21 view .LVU155
 176:TOUCH/ft5206.c ****                     {
 579              		.loc 1 176 31 is_stmt 0 view .LVU156
 580 00e8 294B     		ldr	r3, .L39+8
 581 00ea 93F84430 		ldrb	r3, [r3, #68]	@ zero_extendqisi2
 176:TOUCH/ft5206.c ****                     {
 582              		.loc 1 176 24 view .LVU157
 583 00ee 13F0010F 		tst	r3, #1
 584 00f2 BBD0     		beq	.L26
 178:TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 585              		.loc 1 178 25 is_stmt 1 view .LVU158
 178:TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 586              		.loc 1 178 54 is_stmt 0 view .LVU159
 587 00f4 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 178:TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 588              		.loc 1 178 66 view .LVU160
 589 00f8 1B02     		lsls	r3, r3, #8
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 15


 590 00fa 03F47063 		and	r3, r3, #3840
 178:TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 591              		.loc 1 178 77 view .LVU161
 592 00fe 9DF80120 		ldrb	r2, [sp, #1]	@ zero_extendqisi2
 178:TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 593              		.loc 1 178 72 view .LVU162
 594 0102 1344     		add	r3, r3, r2
 178:TOUCH/ft5206.c ****                         tp_dev.x[i] = ((uint16_t)(buf[2] & 0X0F) << 8) + buf[3];
 595              		.loc 1 178 37 view .LVU163
 596 0104 224A     		ldr	r2, .L39+8
 597 0106 04F11001 		add	r1, r4, #16
 598 010a 22F81130 		strh	r3, [r2, r1, lsl #1]	@ movhi
 179:TOUCH/ft5206.c ****                     }
 599              		.loc 1 179 25 is_stmt 1 view .LVU164
 179:TOUCH/ft5206.c ****                     }
 600              		.loc 1 179 54 is_stmt 0 view .LVU165
 601 010e 9DF80230 		ldrb	r3, [sp, #2]	@ zero_extendqisi2
 179:TOUCH/ft5206.c ****                     }
 602              		.loc 1 179 66 view .LVU166
 603 0112 1B02     		lsls	r3, r3, #8
 604 0114 03F47063 		and	r3, r3, #3840
 179:TOUCH/ft5206.c ****                     }
 605              		.loc 1 179 77 view .LVU167
 606 0118 9DF80310 		ldrb	r1, [sp, #3]	@ zero_extendqisi2
 179:TOUCH/ft5206.c ****                     }
 607              		.loc 1 179 72 view .LVU168
 608 011c 0B44     		add	r3, r3, r1
 179:TOUCH/ft5206.c ****                     }
 609              		.loc 1 179 37 view .LVU169
 610 011e 211D     		adds	r1, r4, #4
 611 0120 02EB4102 		add	r2, r2, r1, lsl #1
 612 0124 9380     		strh	r3, [r2, #4]	@ movhi
 613 0126 BDE7     		b	.L27
 614              	.L37:
 188:TOUCH/ft5206.c **** 
 189:TOUCH/ft5206.c ****                     //printf("x[%d]:%d,y[%d]:%d\r\n", i, tp_dev.x[i], i, tp_dev.y[i]);
 190:TOUCH/ft5206.c ****                 }
 191:TOUCH/ft5206.c ****             }
 192:TOUCH/ft5206.c **** 
 193:TOUCH/ft5206.c ****             res = 1;
 615              		.loc 1 193 13 is_stmt 1 view .LVU170
 616              	.LVL56:
 194:TOUCH/ft5206.c **** 
 195:TOUCH/ft5206.c ****             if (tp_dev.x[0] == 0 && tp_dev.y[0] == 0)sta = 0;   /* 读到的数据都是0,则忽略此次数据 *
 617              		.loc 1 195 13 view .LVU171
 618              		.loc 1 195 25 is_stmt 0 view .LVU172
 619 0128 194B     		ldr	r3, .L39+8
 620 012a 9B89     		ldrh	r3, [r3, #12]
 621              		.loc 1 195 16 view .LVU173
 622 012c 23B9     		cbnz	r3, .L29
 623              		.loc 1 195 45 discriminator 1 view .LVU174
 624 012e 184B     		ldr	r3, .L39+8
 625 0130 1B8C     		ldrh	r3, [r3, #32]
 626              		.loc 1 195 34 discriminator 1 view .LVU175
 627 0132 0BB9     		cbnz	r3, .L29
 628              		.loc 1 195 54 is_stmt 1 discriminator 2 view .LVU176
 629              		.loc 1 195 58 is_stmt 0 discriminator 2 view .LVU177
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 16


 630 0134 8DF80730 		strb	r3, [sp, #7]
 631              	.L29:
 196:TOUCH/ft5206.c **** 
 197:TOUCH/ft5206.c ****             t = 0;  /* 触发一次,则会最少连续监测10次,从而提高命中率 */
 632              		.loc 1 197 13 is_stmt 1 view .LVU178
 633              		.loc 1 197 15 is_stmt 0 view .LVU179
 634 0138 134B     		ldr	r3, .L39
 635 013a 0022     		movs	r2, #0
 636 013c 1A70     		strb	r2, [r3]
 193:TOUCH/ft5206.c **** 
 637              		.loc 1 193 17 view .LVU180
 638 013e 0120     		movs	r0, #1
 639 0140 00E0     		b	.L23
 640              	.LVL57:
 641              	.L33:
 153:TOUCH/ft5206.c ****     uint16_t temp;
 642              		.loc 1 153 13 view .LVU181
 643 0142 0020     		movs	r0, #0
 644              	.LVL58:
 645              	.L23:
 198:TOUCH/ft5206.c ****         }
 199:TOUCH/ft5206.c ****     }
 200:TOUCH/ft5206.c **** 
 201:TOUCH/ft5206.c ****     if ((sta & 0X1F) == 0)  /* 无触摸点按下 */
 646              		.loc 1 201 5 is_stmt 1 view .LVU182
 647              		.loc 1 201 14 is_stmt 0 view .LVU183
 648 0144 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 649              		.loc 1 201 8 view .LVU184
 650 0148 13F01F0F 		tst	r3, #31
 651 014c 0DD1     		bne	.L30
 202:TOUCH/ft5206.c ****     {
 203:TOUCH/ft5206.c ****         if (tp_dev.sta & TP_PRES_DOWN)      /* 之前是被按下的 */
 652              		.loc 1 203 9 is_stmt 1 view .LVU185
 653              		.loc 1 203 19 is_stmt 0 view .LVU186
 654 014e 104A     		ldr	r2, .L39+8
 655 0150 938E     		ldrh	r3, [r2, #52]
 656              		.loc 1 203 13 view .LVU187
 657 0152 B2F93420 		ldrsh	r2, [r2, #52]
 658              		.loc 1 203 12 view .LVU188
 659 0156 002A     		cmp	r2, #0
 660 0158 10DB     		blt	.L38
 204:TOUCH/ft5206.c ****         {
 205:TOUCH/ft5206.c ****             tp_dev.sta &= ~TP_PRES_DOWN;    /* 标记按键松开 */
 206:TOUCH/ft5206.c ****         }
 207:TOUCH/ft5206.c ****         else    /* 之前就没有被按下 */
 208:TOUCH/ft5206.c ****         {
 209:TOUCH/ft5206.c ****             tp_dev.x[0] = 0xffff;
 661              		.loc 1 209 13 is_stmt 1 view .LVU189
 662              		.loc 1 209 25 is_stmt 0 view .LVU190
 663 015a 0D4A     		ldr	r2, .L39+8
 664 015c 4FF6FF71 		movw	r1, #65535
 665 0160 9181     		strh	r1, [r2, #12]	@ movhi
 210:TOUCH/ft5206.c ****             tp_dev.y[0] = 0xffff;
 666              		.loc 1 210 13 is_stmt 1 view .LVU191
 667              		.loc 1 210 25 is_stmt 0 view .LVU192
 668 0162 1184     		strh	r1, [r2, #32]	@ movhi
 211:TOUCH/ft5206.c ****             tp_dev.sta &= 0XE000;           /* 清除点有效标记 */
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 17


 669              		.loc 1 211 13 is_stmt 1 view .LVU193
 670              		.loc 1 211 24 is_stmt 0 view .LVU194
 671 0164 03F46043 		and	r3, r3, #57344
 672 0168 9386     		strh	r3, [r2, #52]	@ movhi
 673              	.L30:
 212:TOUCH/ft5206.c ****         }
 213:TOUCH/ft5206.c ****     }
 214:TOUCH/ft5206.c **** 
 215:TOUCH/ft5206.c ****     if (t > 240)t = 10; /* 重新从10开始计数 */
 674              		.loc 1 215 5 is_stmt 1 view .LVU195
 675              		.loc 1 215 11 is_stmt 0 view .LVU196
 676 016a 074B     		ldr	r3, .L39
 677 016c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 678              		.loc 1 215 8 view .LVU197
 679 016e F02B     		cmp	r3, #240
 680 0170 02D9     		bls	.L32
 681              		.loc 1 215 17 is_stmt 1 discriminator 1 view .LVU198
 682              		.loc 1 215 19 is_stmt 0 discriminator 1 view .LVU199
 683 0172 054B     		ldr	r3, .L39
 684 0174 0A22     		movs	r2, #10
 685 0176 1A70     		strb	r2, [r3]
 686              	.L32:
 216:TOUCH/ft5206.c **** 
 217:TOUCH/ft5206.c ****     return res;
 687              		.loc 1 217 5 is_stmt 1 view .LVU200
 218:TOUCH/ft5206.c **** }
 688              		.loc 1 218 1 is_stmt 0 view .LVU201
 689 0178 03B0     		add	sp, sp, #12
 690              	.LCFI8:
 691              		.cfi_remember_state
 692              		.cfi_def_cfa_offset 12
 693              		@ sp needed
 694 017a 30BD     		pop	{r4, r5, pc}
 695              	.L38:
 696              	.LCFI9:
 697              		.cfi_restore_state
 205:TOUCH/ft5206.c ****         }
 698              		.loc 1 205 13 is_stmt 1 view .LVU202
 205:TOUCH/ft5206.c ****         }
 699              		.loc 1 205 24 is_stmt 0 view .LVU203
 700 017c C3F30E03 		ubfx	r3, r3, #0, #15
 701 0180 034A     		ldr	r2, .L39+8
 702 0182 9386     		strh	r3, [r2, #52]	@ movhi
 703 0184 F1E7     		b	.L30
 704              	.L40:
 705 0186 00BF     		.align	2
 706              	.L39:
 707 0188 00000000 		.word	t.0
 708 018c CDCCCCCC 		.word	-858993459
 709 0190 00000000 		.word	tp_dev
 710 0194 00000000 		.word	lcddev
 711 0198 00000000 		.word	FT5206_TPX_TBL
 712              		.cfi_endproc
 713              	.LFE129:
 715              		.section	.bss.t.0,"aw",%nobits
 718              	t.0:
 719 0000 00       		.space	1
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 18


 720              		.global	FT5206_TPX_TBL
 721              		.section	.rodata.FT5206_TPX_TBL,"a"
 722              		.align	2
 725              	FT5206_TPX_TBL:
 726 0000 0300     		.short	3
 727 0002 0900     		.short	9
 728 0004 0F00     		.short	15
 729 0006 1500     		.short	21
 730 0008 1B00     		.short	27
 731              		.text
 732              	.Letext0:
 733              		.file 2 "C:/Program Files (x86)/Arm GNU Toolchain arm-none-eabi/13.3 rel1/arm-none-eabi/include/ma
 734              		.file 3 "C:/Program Files (x86)/Arm GNU Toolchain arm-none-eabi/13.3 rel1/arm-none-eabi/include/sy
 735              		.file 4 "User/stm32f4xx.h"
 736              		.file 5 "TOUCH/touch.h"
 737              		.file 6 "LCD/lcd.h"
 738              		.file 7 "system/usart/usart.h"
 739              		.file 8 "system/delay/delay.h"
 740              		.file 9 "system/sys/sys.h"
 741              		.file 10 "TOUCH/ctiic.h"
ARM GAS  C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s 			page 19


DEFINED SYMBOLS
                            *ABS*:00000000 ft5206.c
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:21     .text.ft5206_wr_reg:00000000 $t
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:27     .text.ft5206_wr_reg:00000000 ft5206_wr_reg
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:114    .text.ft5206_rd_reg:00000000 $t
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:120    .text.ft5206_rd_reg:00000000 ft5206_rd_reg
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:205    .rodata.ft5206_init.str1.4:00000000 $d
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:209    .text.ft5206_init:00000000 $t
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:215    .text.ft5206_init:00000000 ft5206_init
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:385    .text.ft5206_init:000000e4 $d
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:393    .text.ft5206_scan:00000000 $t
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:399    .text.ft5206_scan:00000000 ft5206_scan
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:707    .text.ft5206_scan:00000188 $d
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:718    .bss.t.0:00000000 t.0
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:725    .rodata.FT5206_TPX_TBL:00000000 FT5206_TPX_TBL
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:719    .bss.t.0:00000000 $d
C:\Users\ktkuru\AppData\Local\Temp\cc3OEn5y.s:722    .rodata.FT5206_TPX_TBL:00000000 $d

UNDEFINED SYMBOLS
ct_iic_start
ct_iic_send_byte
ct_iic_wait_ack
ct_iic_stop
ct_iic_read_byte
sys_gpio_set
ct_iic_init
sys_gpio_pin_set
delay_ms
printf
tp_dev
lcddev
